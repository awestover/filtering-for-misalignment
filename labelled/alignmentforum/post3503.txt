TLDR: I derive a variant of the RL regret bound by Osband and Van Roy (2014) , that applies to learning without resets of environments without traps. The advantage of this regret bound over those known in the literature, is that it scales with certain learning-theoretic dimensions rather than number of states and actions. My goal is building on this result to derive this type of regret bound for DRL , and, later on, other settings interesting from an AI alignment perspective. Previously I derived a regret bound for deterministic environments that scales with prior entropy and "prediction dimension". That bound behaves as O ( √ 1 − γ ) in the episodic setting but only as O ( 3 √ 1 − γ ) in the setting without resets. Moreover, my attempts to generalize the result to stochastic environments led to bounds that are even weaker (have a lower exponent). Therefore, I decided to put that line of attack on hold, and use Osband and Van Roy's technique instead, leading to an O ( √ 1 − γ ) bound in the stochastic setting without resets. This bound doesn't scale down with the entropy of the prior, but this does not seem as important as dependence on γ . Results Russo and Van Roy (2013) introduced the concept of "eluder dimension"  for the benefit of the multi-armed bandit setting, and Osband and Van Roy extended it to a form suitable for studying reinforcement learning. We will consider the following, slightly modified version of their definition. Given a real vector space Y , we will use P S D ( Y ) to denote the set of positive semidefinite bilinear forms on Y and P D ( Y ) to denote the set of positive definite bilinear forms on Y . Given a bilinear form B : Y × Y → R , we will slightly abuse notation by also regarding it as a linear functional B : Y ⊗ Y → R . Thereby, we have B ( v ⊗ w ) = B ( v , w ) and B v ⊗ 2 = B ( v , v ) . Also, if Y is finite-dimensional and B is non-degenerate, we will denote B − 1 : Y ∗ × Y ∗ → R the unique bilinear form which satisfies ∀ v ∈ Y , α ∈ Y ∗ : ( ∀ β ∈ Y ∗ : B − 1 ( α , β ) = β v ) ⟺ ( ∀ w ∈ Y : B ( v , w ) = α w ) Definition 1 Consider a set X , a real vector space Y , some F ⊆ { X → Y } and a family { B x ∈ P S D ( Y ) } x ∈ X . Consider also n ∈ N , a sequence { x k ∈ X } k ∈ [ n ] and x ∗ ∈ X . x ∗ is said to be ( F , B ) -dependant on { x k } when, for any f , ~ f ∈ F n − 1 ∑ k = 0 B x k ( f ( x k ) − ~ f ( x k ) ) ⊗ 2 ≤ 1 ⟹ B x ∗ ( f ( x ∗ ) − ~ f ( x ∗ ) ) ⊗ 2 ≤ 1 Otherwise, x ∗ is said to be ( F , B ) -independent of { x k } . Definition 2 Consider a set X , a real vector space Y and some F ⊆ { X → Y } . The Russo-Van Roy-Osband dimension (RVO dimension) dim R V O F is the supremum of the set of n ∈ N for which there is { x k ∈ X } k ∈ [ n ] and B s.t. for all m ∈ [ n ] , x m is ( F , B ) -independent of { x k } k ∈ [ m ] . We have the following basic bounds on RVO dimension. Proposition 1 Consider a set X , a real vector space Y and some F ⊆ { X → Y } . Then dim R V O F ≤ | X | Proposition 2 Consider a set X , a real vector space Y and some F ⊆ { X → Y } . Then dim R V O F ≤ | F | ( | F | − 1 ) 2 Another concept we need to formulate the regret bound is the Minkowski–Bouligand dimension. Definition 3 Consider a set X , a real vector space Y , some F ⊆ { X → Y } and a family { B x ∈ P S D ( Y ) } x ∈ X . A set A ⊆ F is said to be a B -covering of F when ∀ f ∈ F ∃ ~ f ∈ A : sup x ∈ X B x ( f ( x ) − ~ f ( x ) ) ⊗ 2 < 1 Definition 4 Consider a set X , a real vector space Y , some F ⊆ { X → Y } and a family { B x ∈ P S D ( Y ) } x ∈ X . The covering number N ( F , B ) is the infimum of the set of n ∈ N for which there is a B -covering of F of size n . Definition 5 Consider a finite set X , a finite-dimensional real vector product space Y and some F ⊆ { X → Y } . Fix any { B x ∈ P D ( Y ) } x ∈ X .  The Minkowski–Bouligand dimension (MB dimension) of F is defined by dim M B F : = lim sup ϵ → 0 ln N ( F , ϵ − 2 B ) ln 1 ϵ It is easy to see the above is indeed well-defined, i.e. doesn't depend on the choice of B . This is because given any B , ~ B , there are constants c 1 , c 2 ∈ R + s.t. for all F and ϵ c 1 N ( F , ϵ − 2 B ) ≤ N ( F , ϵ − 2 ~ B ) ≤ c 2 N ( F , ϵ − 2 B ) Similarly, for any { B x ∈ P S D ( Y ) } x ∈ X , we have dim M B F ≥ lim sup ϵ → 0 ln N ( F , ϵ − 2 B ) ln 1 ϵ For finite F and ϵ ≪ 1 , it's obvious that N ( F , ϵ − 2 B ) ≤ | F | , and in particular dim M B F = 0 . It is also possible to show that, for any bounded F , dim M B F ≤ | X | dim Y . Note that, in general, MB dimension is fractional. We will need yet another (but rather simple) notion of "dimension". Definition 6 Consider a set X , a vector space Y and some F ⊆ { X → Y } . The local dimension of F is defined by dim l o c F : = max x ∈ X dim span { f ( x ) | f ∈ F } Obviously dim l o c F ≤ | F | and dim l o c F ≤ dim Y . Consider finite non-empty sets S (states) and A (actions). Observe that Δ S can be regarded as a subset of the vector space R S . This allows us to speak of the RVO, MB and local dimensions of a hypothesis class of transition kernels H ⊆ { S × A k → S } (in this case X = S × A and Y = R S ). We can now formulate the regret bound. Theorem 1 There is some C ∈ R + s.t. the following holds. Consider any finite non-empty sets S and A , R : S → [ 0 , 1 ] , closed set H ⊆ { S × A k → S } and Borel probability measure ζ on H (prior). We define the maximal bias span τ ζ R by τ ζ R : = lim sup γ → 1 max T ∈ H max s ∈ S V T R ( s , γ ) − min s ∈ S V T R ( s , γ ) 1 − γ Denote D l o c : = dim l o c H , D M B : = dim M B H and D R V O : = dim R V O H . Then, there is a family of policies { π † γ : S ∗ × S k → A } γ ∈ ( 0 , 1 ) s.t. lim sup γ → 1 E T ∼ ζ [ E U ∗ T R ( γ ) − E U π † γ T R ( γ ) ] τ ζ R D l o c √ ( D M B + 1 ) D R V O ( 1 − γ ) ln 1 1 − γ ≤ C Here (like in previous essays), V T R ( s , γ ) is the value function for transition kernel T , reward function R , state s and geometric time discount parameter γ ; E U π T R ( γ ) is the expected utility for policy π ; E U ∗ T R ( γ ) is the maximal expected utility over policies. The expression in the numerator is, thereby, the Bayesian regret. The implicit condition τ ζ R < ∞ implies that for any T ∈ H and s , s ′ ∈ S , V 0 T R ( s ) = V 0 T R ( s ′ ) . This is a no-traps condition stronger than the condition A 0 T R ( s ) = A we used before: not only that long-term value cannot be lost in expectation , it cannot be lost at all. For any finite H satisfying this no-traps condition, we have τ ζ R = max T ∈ H ( max s ∈ S V 1 T R ( s ) − min s ∈ S V 1 T R ( s ) ) < ∞ A few directions for improving on this result: It is not hard to see from the proof that it is also possible to write down a concrete bound for fixed γ (rather than considering the γ → 1 limit), but its form is somewhat convoluted. It is probably possible to get an anytime policy with this form of regret, using PSRL with dynamic episode duration. It is interesting to try to make do with the weaker no-traps condition A 0 T R ( s ) = A , especially since a stronger no-traps conditions would translate to a stronger condition on the advisor in DRL. It is interesting to study RVO dimension in more detail. For example, I'm not even sure whether Proposition 2 is the best possible bound in terms of | F | or it's e.g. possible to get a linear bound. It seems tempting to generalize local dimension by allowing the values of f ( x ) to lie on some nonlinear manifold of given dimension for any given x . This approach, if workable, might require a substantially more difficult proof. The "cellular decision processes" discussed previously in "Proposition 3" have exponentially high local dimension, meaning that this regret bound is ineffective for them. We can consider a variant in which, on every time step, only one cell or a very small number of cells (possibly chosen randomly) change. This would have low local dimension. One way to interpret it is, as a continuous time process in which each cell has a certain rate of changing its state. EDIT (2019-07-06): It is actually possible to use Theorem 1 to get an effective regret bound for CDPs, by replacing the CDP with a different but equivalent MDP where each time step is replaced by a series of time steps in which the cells are "decided" one by one. It would be interesting to (i) have an explicit expression for the best possible bound among those generated by such "isomorphisms" for general MDPs (ii) derive bounds on RVO dimension for stochastic analogues of CDPs (possibly defined using Markov random fields). Proofs Proof of Proposition 1 Consider some { x k ∈ X } k ∈ [ m ] and x ∗ ∈ X which is ( F , B ) -independent of { x k } . Then, there are some f , ~ f ∈ F s.t. the following two inequalities hold m − 1 ∑ k = 0 B x k ( f ( x k ) − ~ f ( x k ) ) ⊗ 2 ≤ 1 B x ∗ ( f ( x ∗ ) − ~ f ( x ∗ ) ) ⊗ 2 > 1 The first inequality implies that, for any k ∈ [ m ] , B x k ( f ( x k ) − ~ f ( x k ) ) ⊗ 2 ≤ 1 . Comparing with the second inequality, we conclude that x ∗ ≠ x k . Now suppose that { x k ∈ X } k ∈ [ n ] is s.t. for all m ∈ [ n ] , x m is ( F , B ) -independent of { x k } k ∈ [ m ] . By the previous paragraph, it follows that x m ≠ x k for any m , k ∈ [ n ] s.t. k < m . Hence, n ≤ | X | , Q.E.D. Proof of Proposition 2 Suppose that { x k ∈ X } k ∈ [ n ] is s.t. for all m ∈ [ n ] , x m is ( F , B ) -independent of { x k } k ∈ [ m ] . Then, for each m ∈ [ n ] , we can choose f m , ~ f m ∈ F s.t. the following two inequalities hold m − 1 ∑ k = 0 B x k ( f m ( x k ) − ~ f m ( x k ) ) ⊗ 2 ≤ 1 B x m ( f m ( x m ) − ~ f m ( x m ) ) ⊗ 2 > 1 In particular, the second inequality implies that f m ≠ ~ f m . Now, consider some k ∈ [ m ] . By the first inequality B x k ( f m ( x k ) − ~ f m ( x k ) ) ⊗ 2 ≤ 1 On the other hand, the second inequality with k instead of m gives B x k ( f k ( x k ) − ~ f k ( x k ) ) ⊗ 2 > 1 It follows that { f m , ~ f m } ≠ { f k , ~ f k } . Therefore, n cannot exceed the number of unordered pairs of distinct elements in F , Q.E.D. Given a measurable space X , some μ , ν ∈ Δ X and a measurable function f : X → R , we will use the notation E x ∼ μ − ν [ f ( x ) ] : = E x ∼ μ [ f ( x ) ] − E x ∼ ν [ f ( x ) ] Given X , Y measurable spaces, some K , L : X k → Y and a measurable function f : Y → R , we will use the notation E y ∼ K [ f ( y ) | x ] : = E y ∼ K ( x ) [ f ( y ) ] E y ∼ K − L [ f ( y ) | x ] : = E y ∼ K ( x ) − L ( x ) [ f ( y ) ] Given finite sets S , A , some T : S × A k → S and π : S → A , we will use the notation T π : S k → S defined by T π ( s ) : = T ( s , π ( s ) ) Proposition A.1 In the setting of Theorem 1, fix T ∈ N + and γ ∈ ( 0 , 1 ) . Let Π : H × S → A be a Borel measurable mapping s.t. Π ( T ) is an optimal policy, i.e. E U Π ( T ) T R ( γ ) = E U ∗ T R ( γ ) Let π PS ζ Π T : S ∗ × S k → A be the policy implemented by a PSRL algorithm with prior ζ and episode length T , s.t. whenever hypothesis T is sampled, policy Π ( T ) is followed. Denote the Bayesian regret by R ( γ ) : = E T ∼ ζ [ E U ∗ T R ( γ ) − E U π PS ζ Π T T R ( γ ) ] Let ( Ω , P ) be a probability space governing both the uncertainty about the true hypothesis, the stochastic behavior of the environment and the random sampling inside the algorithm. [See the proof of "Lemma 1" in this previous essay or the proof of "Theorem 1" in another previous essay.] Furthermore, let H ∗ : Ω → H be a random variable representing the true hypothesis, { H n : Ω → H } n ∈ N be the random variables s.t. H n represents the hypothesis sampled at time n (i.e. during episode number ⌊ n / T ⌋ ), { Θ n : Ω → S } n ∈ N be random variables s.t. Θ n represents the state at time n and { A n : Ω → A } n ∈ N be random variables s.t. A n represents the action taken at time n . Denote E l : = H ∗ Π ( H l T ) and ¯ E l : = H l T Π ( H ∗ ) . Then R ( γ ) = ∞ ∑ n = 0 γ n + 1 E [ E H n − H ∗ [ V H n R ( γ ) | Θ n , A n ] ] + ∞ ∑ l = 0 γ ( l + 1 ) T E [ E ¯ E T l − E T l [ V H ∗ R ( γ ) | Θ l T ] ] Here, E T l means raising E l to the T -th power w.r.t. Markov kernel composition, and the same for ¯ E T l . We will use the notation V T π R ( s , γ ) to stand for the expected utility achieved by policy π when starting from state s with transition kernel T , reward function R and time discount parameter γ . Proof of Proposition A.1 For any n ∈ N , define Π n : H × H × S ∗ × S k → A as follows. Π n ( T 1 , T 2 , h , s ) : = { Π ( T 1 , s ) if | h | < n Π ( T 2 , s ) if | h | ≥ n That is, Π n ( T 1 , T 2 ) is a policy that follows Π ( T 1 ) for time n and Π ( T 2 ) afterwards. In the following, we use the shorthand notation V ∗ ( s ) : = V H ∗ R ( s , γ ) V l ( s ) : = V H l T R ( s , γ ) V l k ( s ) : = V H ∗ Π T − k ( H l T , H ∗ ) R ( s , γ ) It is easy to see that R ( γ ) = ∞ ∑ l = 0 γ l T E [ V ∗ ( Θ l T ) − V l 0 ( Θ l T ) ] The above is essentially what appeared as "Proposition B.1" before , for the special case of PSRL, and where we regard every episode as a single time step in a new MDP in which every action is a policy for the duration of an episode in the original MDP. By definition, H l T and H ∗ have the same distribution even when conditioned by the history up to l T . Therefore E [ V ∗ ( Θ l T ) ] = E [ V l ( Θ l T ) ] It follows that R ( γ ) = ∞ ∑ l = 0 γ l T E [ V l ( Θ l T ) − V l 0 ( Θ l T ) ] We now prove by induction on k ∈ [ T + 1 ] that E [ V l ( Θ l T ) − V l 0 ( Θ l T ) ] = l T + k − 1 ∑ n = l T γ n − l T + 1 E [ E H n − H ∗ [ V l | Θ n , A n ] ] + γ k E [ V l ( Θ l T + k ) − V l k ( Θ l T + k ) ] For k = 0 this is a tautology. For any k ∈ [ T ] , the Bellman equation says that V l ( s ) = ( 1 − γ ) R ( s ) + γ E H l T Π ( H l T ) [ V l | s ] V l k ( s ) = ( 1 − γ ) R ( s ) + γ E H ∗ Π ( H l T ) [ V l , k + 1 | s ] It follows that E [ V l ( Θ l T + k ) − V l k ( Θ l T + k ) ] = γ E [ E H l T Π ( H l T ) [ V l | Θ l T + k ] − E H ∗ Π ( H l T ) [ V l , k + 1 | Θ l T + k ] ] Since Π ( H l T ) is exactly the policy followed by PSRL at time l T + k , we get E [ V l ( Θ l T + k ) − V l k ( Θ l T + k ) ] = γ E [ E H l T [ V l | Θ l T + k , A l T + k ] − E H ∗ [ V l , k + 1 | Θ l T + k , A l T + k ] ] We now subtract and add E H ∗ [ V l | Θ l T + k , A l T + k ] , and use the fact that H ∗ ( Θ l T + k , A l T + k ) is the conditional distribution of Θ l T + k + 1 . E [ V l ( Θ l T + k ) − V l k ( Θ l T + k ) ] = γ E [ E H l T − H ∗ [ V l | Θ l T + k , A l T + k ] + V l ( Θ l T + k + 1 ) − V l , k + 1 ( Θ l T + k + 1 ) ] Applying this identity to the second second term on the right hand side of the induction hypothesis, we prove the induction step. For k = T , we get, denoting n 0 : = l T and n 1 : = ( l + 1 ) T E [ V l ( Θ n 0 ) − V l 0 ( Θ n 0 ) ] = n 1 − 1 ∑ n = n 0 γ n − n 0 + 1 E [ E H n − H ∗ [ V l | Θ n , A n ] ] + γ T E [ V l ( Θ n 1 ) − V ∗ ( Θ n 1 ) ] Clearly E [ V l ( Θ n 1 ) ] = E [ E E T l [ V l ∣ ∣ Θ n 0 ] ] E [ V ∗ ( Θ n 1 ) ] = E [ E E T l [ V ∗ ∣ ∣ Θ n 0 ] ] Using the definition of PSRL, we can exchange and true and sampled hypothesis and get E [ V l ( Θ n 1 ) ] = E [ E ¯ E T l [ V ∗ ∣ ∣ Θ n 0 ] ] It follows that E [ V l ( Θ n 0 ) − V l 0 ( Θ n 0 ) ] = n 1 − 1 ∑ n = n 0 γ n − n 0 + 1 E [ E H n − H ∗ [ V l | Θ n , A n ] ] + γ T E [ E ¯ E T l − E T l [ V ∗ ∣ ∣ Θ n 0 ] ] Applying this to each term in the earlier expression for R ( γ ) , we get the desired result. Q.E.D. Proposition A.2 Consider a real finite-dimensional normed vector space Y and a linear subspace Z ⊆ Y . Then, there exists B ∈ P S D ( Y ) s.t. For any v ∈ Y , B v ⊗ 2 ≤ ∥ v ∥ 2 For any v ∈ Z , ( dim Z ) 2 B v ⊗ 2 ≥ ∥ v ∥ 2 Proof of Proposition A.2 We assume dim Z > 0 since otherwise the claim is trivial (take B = 0 ). By Theorem B.1 (see Appendix), there is ~ B ∈ P S D ( Z ) s.t. for any v ∈ Z ~ B v ⊗ 2 ≤ ∥ v ∥ 2 ≤ dim Z ⋅ ~ B v ⊗ 2 By Corollary B.1 (see Appendix), there is a projection operator P : Y → Y s.t. im Y = Z and ∥ P ∥ ≤ √ dim Z . We define B ∈ P S D ( Y ) by B ( v , w ) : = ~ B ( P v , P w ) dim Z For any v ∈ Y , we have B v ⊗ 2 = ~ B ( P v , P v ) dim Z ≤ ∥ P v ∥ 2 dim Z ≤ ∥ P ∥ 2 ∥ v ∥ 2 dim Z ≤ ∥ v ∥ 2 For any v ∈ Z , we have P v = v and therefore ∥ v ∥ 2 ≤ dim Z ⋅ ~ B v ⊗ 2 = ( dim Z ) 2 ~ B ( P v , P v ) dim Z = ( dim Z ) 2 B v ⊗ 2 Q.E.D. Proposition A.3 Consider a finite-dimensional real vector space Y , some B ∈ P D ( Y ) and a Borel probability measure μ ∈ Δ Y s.t. Pr y ∼ μ [ B y ⊗ 2 ≤ 1 ] = 1 . Let y 0 : = E y ∼ μ [ y ] and σ : = 2 √ 2 . Then, μ is σ -sub-Gaussian w.r.t. B , i.e., for any α ∈ Y ∗ E y ∼ μ [ exp ( α ( y − y 0 ) ) ] ≤ exp ( σ 2 B − 1 α ⊗ 2 2 ) Proof of Proposition A.3 By isomorphism, it is sufficient to consider the case Y = R n , B ( v , w ) = v ⋅ w , α ( v ) = t v 0 for some n ∈ N and t ∈ [ 0 , ∞ ) . For this form of α it is sufficient to consider the case n = 1 . It remains to show that E y ∼ μ [ e t ( y − y 0 ) ] ≤ e 1 2 σ 2 t 2 = e 4 t 2 Here, we assume that Pr y ∼ μ [ | y | ≤ 1 ] = 1 . We consider separately the cases t ≥ 1 2 and t < 1 2 . In the first case E y ∼ μ [ e t ( y − y 0 ) ] ≤ max y ∈ [ − 1 , + 1 ] e t ( y − y 0 ) ≤ e 2 t ≤ e ( 2 t ) 2 = e 4 t 2 In the second case, we use that for any x ∈ ( − ∞ , + 1 ] e x < 1 + x + e 2 x 2 The above holds because, at x = 0 the left hand side and the right hand have the same value and first derivative, and for any x ∈ ( − ∞ , + 1 ) , the second derivative of the left hand side is less than the second derivative of the right hand side. We get E y ∼ μ [ e t ( y − y 0 ) ] ≤ E y ∼ μ [ 1 + t ( y − y 0 ) + e 2 t 2 ( y − y 0 ) 2 ] = 1 + e 2 t 2 Var y ∼ μ [ y ] ≤ 1 + e 2 t 2 ≤ e e 2 t 2 ≤ e 4 t 2 Q.E.D. Definition A.1 Consider a set X , a finite-dimensional real vector space Y , some F ⊆ { X → Y } and a family { B x ∈ P S D ( Y ) } x ∈ X . Assume F is compact w.r.t. the product topology on X → Y ≅ ∏ x ∈ X Y . Consider also some n ∈ N , x ∈ X n and y ∈ Y n . We then use the notation L S F [ x y , B ] : = a r g m i n f ∈ F n − 1 ∑ m = 0 B x m ( f ( x m ) − y m ) ⊗ 2 C S F [ x y , B ] : = { f ∈ F ∣ ∣
∣ ∣ n − 1 ∑ m = 0 B x m ( f ( x m ) − L S F [ x y , B ] ( x m ) ) ⊗ 2 ≤ 1 } I chose the notation L S as an abbreviation of "least squares" and C S as an abbreviation of "confidence set". Note that L S is somewhat ambiguous (and therefore, so is C S ) since there might be multiple minima, but this will not be important in the following (i.e. an arbitrary minimum can be chosen). Proposition A.4 There is some C A .4 ∈ R + s.t. the following holds. Consider finite sets X , S , some F ⊆ { X k → S } and a family { B x ∈ P S D ( R S ) } x ∈ X . Assume that for any x ∈ X and φ ∈ Δ S , B x φ ⊗ 2 ≤ 1 . Let { H n ⊆ P ( X ω × S ω ) } n ∈ N be the canonical filtration, i.e. H n : = { A ′ ⊆ X ω × S ω ∣ ∣ A ′ = { x s | x s : n ∈ A } , A ⊆ X n × S n } Consider also f ∗ ∈ F and μ ∈ Δ ( X ω × S ω ) s.t. for any n ∈ N , x ∈ X , and s ∈ S Pr x s ∼ μ [ s n = s | x n = x , H n ] = f ∗ ( s ∣ x ) Fix ϵ ∈ R + , δ ∈ ( 0 , 1 ) . Denote β ( t ) : = C A .4 ( ln N ( F , ϵ − 2 B ) δ + ϵ t ln e t δ ) Then, Pr x s ∼ μ [ f ∗ ∉ ∞ ⋂ n = 0 C S F [ x s : n , β ( n + 1 ) − 1 B ] ] ≤ δ Proof of Proposition A.4 For each x ∈ X , choose a finite set E x and a linear mapping P x : R S → R E x s.t. B x ( v , w ) = P x ( v ) ⋅ P x ( w ) . Let ~ Y : = ⨁ x ∈ X R E x . Define ~ F ⊆ { X → ~ Y } by ~ F : = { ~ f : X → ~ Y ∣ ∣ ~ f ( x ) = P x ( f ( x ) ) , f ∈ F } Define P ω : X ω × S ω → X ω × ~ Y ω by P ω ( x s ) n : = x n P x n ( s n ) Let ~ f ∗ : = P ω ( f ∗ ) and ~ μ : = P ω ∗ μ . By Proposition A.3, ~ μ is 2 √ 2 -sub-Gaussian. Applying Proposition B.1 (see Appendix) to the tilde objects gives the desired result. Here, we choose the constant C A.4 s.t. the term M = 1 in β as defined in Proposition B.1 is absorbed by the term σ ln e t δ ≥ 1 (note that t ≥ 1 since we substitute t = n + 1 , δ < 1 and σ = 2 √ 2 > 1 ). Q.E.D. Definition A.2 Consider a set X , some x ∈ X , a real vector space Y , some F ⊆ { X → Y } and a family { B x ∈ P S D ( Y ) } x ∈ X . The B -width of F at x is defined by W F ( x , B ) : = sup f , ~ f ∈ F √ B x ( f ( x ) − ~ f ( x ) ) ⊗ 2 Proposition A.5 There is some C A .5 ∈ R + s.t. the following holds. Consider a set X , a real vector space Y , some F ⊆ { X → Y } and a family { B x ∈ P S D ( Y ) } x ∈ X . Consider also some x ∈ X ω , y ∈ Y ω , T ∈ N + , γ ∈ ( 0 , 1 ) , θ ∈ R + , η 0 , η 1 ∈ R + and δ ∈ ( 0 , 1 ) . Denote β ( t ) : = η 0 + η 1 t ln e t δ For any n ∈ N , define F n by F n : = C S F [ x y : n , β ( n + 1 ) − 1 B ] Assume that γ T > 1 2 . Then, ∞ ∑ l = 0 T − 1 ∑ m = 0 γ l T + m [ [ W F l T ( x l T + m , B ) > θ ] ] ≤ C A .5 dim R V O F ⋅ ( θ − 2 β ( 1 1 − γ ) + T ) Proof of Proposition A.5 For each x ∈ X , choose a finite set E x and a linear mapping P x : Y → R E x s.t. B x ( v , w ) = P x ( v ) ⋅ P x ( w ) . Let ~ Y : = ⨁ x ∈ X R E x . Define ~ F ⊆ { X → ~ Y } by ~ F : = { ~ f : X → ~ Y ∣ ∣ ~ f ( x ) = P x ( f ( x ) ) , f ∈ F } Define also ~ y by ~ y n = P x n ( y n ) Applying Proposition B.2 (see Appendix) to the tilde objects, we conclude that for any N ∈ N N − 1 ∑ l = 0 T − 1 ∑ m = 0 [ [ W F l T ( x l T + m , B ) > θ ] ] ≤ dim R V O F ⋅ ( 4 θ − 2 β ( N T ) + T ) Multiplying the inequality by γ N T and summing over N , we get ∞ ∑ l = 0 ( ∞ ∑ N = l + 1 γ N T ) T − 1 ∑ m = 0 [ [ W F l T ( x l T + m , B ) > θ ] ] ≤ dim R V O F ∞ ∑ N = 0 γ N T ( 4 θ − 2 β ( N T ) + T ) On the left hand side, we sum the geometric series. On the right hand side, we use the observation that γ N T ( 4 θ − 2 β ( N T ) + T ) ≤ 1 T ∫ T 0 γ N T + t − T ( 4 θ − 2 β ( N T + t ) + T ) d t γ N T ( 4 θ − 2 β ( N T ) + T ) ≤ 1 T γ T ∫ T 0 γ N T + t ( 4 θ − 2 β ( N T + t ) + T ) d t Here, we used that β ( t ) is an increasing function for t ≥ 1 and β ( 0 ) = 0 . We get ∞ ∑ l = 0 γ ( l + 1 ) T 1 − γ T T − 1 ∑ m = 0 [ [ W F l T ( x l T + m , B ) > θ ] ] ≤ dim R V O F T γ T ∫ ∞ 0 γ t ( 4 θ − 2 β ( t ) + T ) d t The integral on the right hand side is a Laplace transform (where the dual variable is s = ln 1 γ ). The functions f ( t ) = 1 , f ( t ) = t and f ( t ) = t ln t all have the property that, for any s ∈ R + L [ f ] ( s ) ≤ 1 s f ( 1 s ) Indeed, we have L [ 1 ] ( s ) = 1 s ≤ 1 s L [ t ] ( s ) = 1 s 2 ≤ 1 s ⋅ 1 s L [ t ln t ] ( s ) = − ln s + γ EM − 1 s 2 = 1 s ⋅ 1 s ( ln 1 s + 1 − γ EM ) ≤ 1 s ⋅ 1 s ln 1 s Here, γ EM is the Euler-Mascheroni constant. We conclude γ T 1 − γ T ∞ ∑ l = 0 γ l T T − 1 ∑ m = 0 [ [ W F l T ( x l T + m , B ) > θ ] ] ≤ dim R V O F T γ T ⋅ 1 ln 1 γ ⎛ ⎝ 4 θ − 2 β ⎛ ⎝ 1 ln 1 γ ⎞ ⎠ + T ⎞ ⎠ Using the condition γ T > 1 2 and absorbing O ( 1 ) factors into the definition of C A.5 , we get ∞ ∑ l = 0 γ l T T − 1 ∑ m = 0 [ [ W F l T ( x l T + m , B ) > θ ] ] ≤ C A.5 dim R V O F ⋅ ( θ − 2 β ( 1 1 − γ ) + T ) Since γ m ≤ 1 , this implies ∞ ∑ l = 0 T − 1 ∑ m = 0 γ l T + m [ [ W F l T ( x l T + m , B ) > θ ] ] ≤ C A .5 dim R V O F ⋅ ( θ − 2 β ( 1 1 − γ ) + T ) Q.E.D. Proposition A.6 There is some C A .6 ∈ R + s.t. the following holds. Consider a set X , a real vector space Y , some F ⊆ { X → Y } and a family { B x ∈ P S D ( Y ) } x ∈ X . Assume that for any x ∈ X and f ∈ F , B x f ( x ) ⊗ 2 ≤ 1 . Consider also some x ∈ X ω , y ∈ Y ω , T ∈ N + , γ ∈ ( 0 , 1 ) , η 0 , η 1 ∈ R + and δ ∈ ( 0 , 1 ) . Define β and F n the same way as in Proposition A.5. Denote D : = dim R V O F . Assume D > 0 and γ T > 1 2 . Then, ∞ ∑ l = 0 T − 1 ∑ m = 0 γ l T + m W F l T ( x l T + m , B ) ≤ C A .6 ( D T + √ D β ( 1 1 − γ ) 1 1 − γ ) Proof of Proposition A.6 Due to the assumption B x f ( x ) ⊗ 2 ≤ 1 , we have W F n ( x , B ) ≤ 2 . For any t ∈ R + , we have W F l T ( x l T + m , B ) = ∫ 2 0 [ [ W F l T ( x l T + m , B ) > θ ] ] d θ ≤ t + ∫ 2 t [ [ W F l T ( x l T + m , B ) > θ ] ] d θ ∞ ∑ l = 0 T − 1 ∑ m = 0 γ l T + m W F l T ( x l T + m , B ) ≤ t 1 − γ + ∫ 2 t ∞ ∑ l = 0 T − 1 ∑ m = 0 γ l T + m [ [ W F l T ( x l T + m , B ) > θ ] ] d θ Applying Proposition A.5 to the right hand side ∞ ∑ l = 0 T − 1 ∑ m = 0 γ l T + m W F l T ( x l T + m , B ) ≤ t 1 − γ + C A.5 D ∫ 2 t ( θ − 2 β ( 1 1 − γ ) + T ) d θ Evaluating the integral and dropping some negative terms on the right hand side, we get ∞ ∑ l = 0 T − 1 ∑ m = 0 γ l T + m W F l T ( x l T + m , B ) ≤ t 1 − γ + C A.5 D ( 1 t β ( 1 1 − γ ) + 2 T ) We now set t to be t : = √ D β ( 1 1 − γ ) ⋅ ( 1 − γ ) For an appropriate choice of C A.6 , it follows that ∞ ∑ l = 0 T − 1 ∑ m = 0 γ l T + m W F l T ( x l T + m , B ) ≤ C A.6 ( D T + √ D β ( 1 1 − γ ) 1 1 − γ ) Q.E.D. Proof of Theorem 1 We take π † γ : = π PS ζ Π T where Π is as in Proposition A.1 and T ∈ N + will be specified later. Denote the Bayesian regret by R ( γ ) : = E T ∼ ζ [ E U ∗ T R ( γ ) − E U π † γ T R ( γ ) ] By Proposition A.1 R ( γ ) = ∞ ∑ n = 0 γ n + 1 E [ E H n − H ∗ [ V H n R ( γ ) | Θ n , A n ] ] + ∞ ∑ l = 0 γ ( l + 1 ) T E [ E ¯ E T l − E T l [ V H ∗ R ( γ ) | Θ l T ] ] R ( γ ) ≤ ∞ ∑ n = 0 γ n E [ ∣ ∣ ∣ E H n − H ∗ [ V H n R ( γ ) | Θ n , A n ] ∣ ∣ ∣ ] + ∞ ∑ l = 0 γ l T E [ ∣ ∣
∣ ∣ E ¯ E T l − E T l [ V H ∗ R ( γ ) | Θ l T ] ∣ ∣
∣ ∣ ] We will use the notation Δ V ( γ ) : = max T ∈ H ( max s ∈ S V T R ( s , γ ) − min s ∈ S V T R ( s , γ ) ) It follows that R ( γ ) ≤ Δ V ( γ ) ( ∞ ∑ n = 0 γ n E [ d tv ( H n ( Θ n , A n ) , H ∗ ( Θ n , A n ) ) ] + ∞ ∑ l = 0 γ l T E [ d tv ( E T l T ( Θ l T ) , ¯ E T l T ( Θ l T ) ) ] ) R ( γ ) ≤ Δ V ( γ ) ( ∞ ∑ n = 0 γ n E [ d tv ( H n ( Θ n , A n ) , H ∗ ( Θ n , A n ) ) ] + 1 1 − γ T ) Consider Y = R S equipped with the L 1 norm. Given s ∈ S and a ∈ A , consider also the subspace W s a : = span { T ( s , a ) | T ∈ H } By Proposition A.2, there is B s a ∈ P S D ( Y ) s.t. For any φ ∈ Δ S B s a φ ⊗ 2 ≤ 1 For any T , ~ T ∈ H 1 4 D 2 l o c B s a ( T ( s , a ) − ~ T ( s , a ) ) ⊗ 2 ≥ d tv ( T ( s , a ) , ~ T ( s , a ) ) 2 We now apply Proposition A.4 with δ : = 1 2 ( 1 − γ ) 2 and ϵ : = ( 1 − γ ) 2 . We get Pr [ H ∗ ∈ ∞ ⋂ n = 0 C S H [ Θ A : n Θ n , β ( n + 1 ) − 1 B ] ] ≥ 1 − 1 2 ( 1 − γ ) 2 Here, β was defined in Proposition A.4. Since the hypothesis H n is sampled from the posterior, for any l ∈ N we also have Pr [ H l T ∈ C S H [ Θ A : l T Θ l T , β ( l T + 1 ) − 1 B ] ] ≥ 1 − 1 2 ( 1 − γ ) 2 Pr [ H ∗ , H l T ∈ C S H [ Θ A : l T Θ l T , β ( l T + 1 ) − 1 B ] ] ≥ 1 − ( 1 − γ ) 2 Denote G n : = { H ∗ , H l T ∈ C S H [ Θ A : l T Θ l T , β ( l T + 1 ) − 1 B ] } ⊆ Ω We get R ( γ ) ≤ Δ V ( γ ) ∞ ∑ n = 0 γ n ( E [ d tv ( H n ( Θ n , A n ) , H ∗ ( Θ n , A n ) ) ; G n ] + ( 1 − γ ) 2 ) R ( γ ) ≤ Δ V ( γ ) ( ∞ ∑ n = 0 γ n E [ d tv ( H n ( Θ n , A n ) , H ∗ ( Θ n , A n ) ) ; G n ] + 1 − γ + 1 1 − γ T ) Using property 2 of B R ( γ ) ≤ Δ V ( γ ) ( 1 2 D l o c ∞ ∑ n = 0 γ n E [ √ B Θ n A n ( H n ( Θ n , A n ) − H ∗ ( Θ n , A n ) ) ⊗ 2 ; G n ] + 1 − γ + 1 1 − γ T ) Denote H l : = C S H [ Θ A : l T Θ l T , β ( l T + 1 ) − 1 B ] Clearly Pr [ √ B Θ n A n ( H n ( Θ n , A n ) − H ∗ ( Θ n , A n ) ) ⊗ 2 ≤ W H ⌊ n / T ⌋ ( Θ n A n , B ) ∣ ∣ ∣ G n ] = 1 Using this inequality, dropping the ; G n (since it can only the right hand side smaller) and moving the sum inside the expected value, we get R ( γ ) ≤ Δ V ( γ ) ( 1 2 D l o c E [ ∞ ∑ n = 0 γ n W H ⌊ n / T ⌋ ( Θ n A n , B ) ] + 1 − γ + 1 1 − γ T ) We will now assume D R V O > 0 (if D R V O = 0 , then | H | = 1 and R ( γ ) = 0 ) and γ T > 1 2 . Applying Proposition A.6, we conclude R ( γ ) ≤ Δ V ( γ ) ( D l o c C A .6 2 ( D R V O T + √ D R V O β ( 1 1 − γ ) 1 1 − γ ) + 1 − γ + 1 1 − γ T ) Denote the second factor on the right hand side F ( γ ) , so that the inequality becomes R ( γ ) ≤ Δ V ( γ ) F ( γ ) We set T : = ⎢ ⎢
⎢
⎢
⎢ ⎣ 1 √ D l o c D R V O ( 1 − γ ) ln 1 1 − γ ⎥ ⎥
⎥
⎥
⎥ ⎦ Now, we analyze the γ → 1 limit. In this limit, the expression for T justifies our assumption that γ T > 1 2 . Indeed, we have lim γ → 1 ln γ T = lim γ → 1 T ln γ = lim γ → 1 ln γ √ D l o c D R V O ( 1 − γ ) ln 1 1 − γ = 0 Using the previous inequality for R ( γ ) , we get lim sup γ → 1 R ( γ ) √ ( 1 − γ ) ln 1 1 − γ ≤ lim sup γ → 1 Δ V ( γ ) F ( γ ) √ ( 1 − γ ) ln 1 1 − γ We assume τ ζ R < ∞ , otherwise the theorem is vacuous. Multiplying the numerator and denominator on the right hand side by √ 1 − γ , we get lim sup γ → 1 R ( γ ) √ ( 1 − γ ) ln 1 1 − γ ≤ τ ζ R lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅ F ( γ ) We will now analyze the contribution of each term in F ( γ ) to the limit on the right hand side (using the fact that lim sup ( F 1 + F 2 ) ≤ lim sup F 1 + lim sup F 2 ). We ignore multiplicative constants that can be absorbed into C . The first term gives (using our choice of T ) lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅  
 ⎷ D l o c D R V O ( 1 − γ ) ln 1 1 − γ = 0 The second term gives (using the definitions of β and our choices of δ and ϵ ) lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅ D l o c  
 ⎷ D R V O ( ln 2 N ( H , ( 1 − γ ) − 4 B ) ( 1 − γ ) 2 + ( 1 − γ ) ln 2 e ( 1 − γ ) 3 ) 1 1 − γ ≤ lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅ D l o c √ D R V O 1 − γ ⎛ ⎝ √ ln N ( H , ( 1 − γ ) − 4 B ) + √ ln 2 ( 1 − γ ) + √ ( 1 − γ ) ln 2 e ( 1 − γ ) 3 ⎞ ⎠ We analyze each subterm separately. The first subterm gives lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅ D l o c √ D R V O 1 − γ ln N ( H , ( 1 − γ ) − 4 B ) = D l o c √ D R V O lim sup γ → 1  
 ⎷ ln N ( H , ( 1 − γ ) − 4 B ) 1 2 ln 1 ( 1 − γ ) 2 ≤ D l o c √ 2 D R V O D M B The second subterm gives lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅ D l o c √ D R V O 1 − γ ln 2 1 − γ = D l o c √ D R V O The third subterm gives lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅ D l o c √ D R V O 1 − γ ( 1 − γ ) ln 2 e ( 1 − γ ) 3 = 0 The third and fourth terms give lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅ ( 1 − γ ) = 0 To analyze the fifth term, observe that lim γ → 1 ( 1 − γ ) T ( γ ) = 0 . Hence lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅ 1 1 − γ T ( γ ) = lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅ 1 ( 1 − γ ) T ( γ ) = lim sup γ → 1  
 ⎷ 1 − γ ln 1 1 − γ ⋅ √ D l o c D R V O ( 1 − γ ) ln 1 1 − γ ( 1 − γ ) = √ D l o c D R V O Putting everything together, we observe that the expression D l o c √ D R V O ( D M B + 1 ) dominates all the terms (up to a multiplicative constant). Here, we use that D l o c is an integer and hence D l o c ≥ √ D l o c . We conclude lim sup γ → 1 R ( γ ) √ ( 1 − γ ) ln 1 1 − γ ≤ C τ ζ R D l o c √ D R V O ( D M B + 1 ) Q.E.D. Appendix The following was proved in John (1948), available in the collection Giorgi and Kjeldesen (2014) (the theorem in question is on page 214). Theorem B.1 (John) Consider a real finite-dimensional normed vector space Y . Then, there exists B ∈ P D ( Y ) s.t. for any v ∈ Y B v ⊗ 2 ≤ ∥ v ∥ 2 ≤ dim Y ⋅ B v ⊗ 2 The following is from Kadets and Snobar (1971) . Theorem B.2 (Kadets-Snobar) Consider a real Banach space Y and a finite-dimensional linear subspace Z ⊆ Y . Then, for any ϵ ∈ R + , there is a projection operator P : Y → Y s.t. im P = Z and ∥ P ∥ < √ dim Z + ϵ . Corollary B.1 Consider a real finite-dimensional normed vector space Y and a linear subspace Z ⊆ Y . Then, there is a projection operator P ⋆ : Y → Y s.t. im P ⋆ = Z and ∥ P ⋆ ∥ ≤ √ dim Z . Proof of Corollary B.1 Let E n d ( Y ) be the vector space of linear operators Y → Y . Define P r ( Y , Z ) : = { P ∈ E n d ( Y ) ∣ ∣ P 2 = P , im P = Z } X : = { P ∈ P r ( Y , Z ) ∣ ∣ ∥ P ∥ ≤ √ dim Z + 1 } P r ( Y , Z ) is an affine subspace of E n d ( Y ) and X is a compact set. Define f : X → R by f ( P ) : = ∥ P ∥ . f is a continuous function. By Theorem B.2, inf f ≤ √ dim Z . Since X is compact, f attains its infimum at some P ⋆ ∈ X , and we have f ( P ⋆ ) ≤ √ dim Z , Q.E.D. The next proposition appeared (in slightly greater generality) in Osband and Van Roy as "Proposition 5". We will use I d ∈ P D ( R d ) to denote the form corresponding to the identity matrix. Proposition B.1 (Osband-Van Roy) There is some C B .1 ∈ R + s.t. the following holds. Consider a finite set X , the vector space Y : = R d for some d ∈ N and some F ⊆ { X → Y } . Let { H n ⊆ P ( X ω × Y ω ) } n ∈ N be the canonical filtration, i.e. H n : = { A ′ ⊆ X ω × Y ω ∣ ∣ A ′ = { x y | x y : n ∈ A } , A ⊆ X n × Y n Borel } Consider also f ∗ ∈ F and μ ∈ Δ ( X ω × Y ω ) s.t. for any n ∈ N and x ∈ X E x y ∼ μ [ y n | x n = x , H n ] = f ∗ ( x ) Assume that M ∈ R + is s.t. y n ⋅ y n ≤ M 2 with μ -probability 1 for all n ∈ N . Assume also that σ ∈ R + is s.t. μ is σ -sub-Gaussian, i.e., for any α ∈ Y , n ∈ N and x ∈ X E x y ∼ μ [ exp ( α ⋅ ( y n − f ∗ ( x ) ) ) | x n = x , H n ] ≤ exp ( σ 2 ( α ⋅ α ) 2 ) Fix ϵ ∈ R + , δ ∈ ( 0 , 1 ) . Define β : R + → R by β ( t ) : = C B .1 ( σ 2 ln N ( F , ϵ − 2 I d ) δ + ϵ t ( M + σ ln e t δ ) ) Then, Pr x y ∼ μ [ f ∗ ∉ ∞ ⋂ n = 0 C S F [ x y : n , β ( n + 1 ) − 1 I d ] ] ≤ δ Note that we removed a square root in the definition of β compared to equation (7) in Osband and Van Roy. This only makes β larger (up to a constant factor) and therefore, only makes the claim weaker. The proposition below appeared in Osband and Van Roy as "Lemma 1". Proposition B.2 (Osband-Van Roy) Consider a set X , the vector space Y = R d for some d ∈ N and some F ⊆ { X → Y } . Consider also some x ∈ X ω , y ∈ Y ω , T ∈ N + , N ∈ N , θ ∈ R + and a nondecreasing sequence { β n ∈ R + } n ∈ N . For any n ∈ N , define F n by F n : = C S F [ x y : n , β − 1 n I d ] Then, N − 1 ∑ l = 0 T − 1 ∑ m = 0 [ [ W F l T ( x l T + m , I d ) > θ ] ] ≤ dim R V O F ⋅ ( 4 θ − 2 β N T − 1 + T )