In this post, given a finite factored set F = ( S , B ) , we will show how to associate each E ⊆ S with a characteristic polynomial, Q F E . We will discuss how to factor these characteristic polynomials, and use these characteristic polynomials to build up to the fundamental theorem of finite factored sets, which associates conditional orthogonality with conditional independence in probability distributions. 5.1. Characteristic Polynomials Definition 28. Given a finite factored set F = ( S , B ) , let Poly F denote the ring of polynomials with coefficients in R and variables in P ( S ) . Definition 29. Given a finite factored set F = ( S , B ) , a p ∈ Poly F , and an f : P ( S ) → R , we write p ( f ) ∈ R for the evaluation of p at f , computed by replacing each E ⊆ S with f ( E ) . Definition 30. Given a finite factored set F = ( S , B ) , and a polynomial p ∈ Poly F , supp ( p ) ⊆ P ( S ) denotes the set of all variables v ∈ P ( S ) that appear in p . supp ( p ) is called the support of p . Definition 31. Given a finite factored set F = ( S , B ) and an E ⊆ S , let Q F E ∈ Poly F be given by Q F E = ∑ s ∈ E ∏ b ∈ B [ s ] b . Q F E is called the characteristic polynomial of E (in F ). We will be building up to an understanding of how to factor Q F E into irreducibles. For that, we will first need to give some basic notation for manipulating polynomials in Poly F . Definition 32. Given a finite factored set F = ( S , B ) , an s ∈ S , and a C ⊆ B , let mono F C ( s ) ∈ Poly F be given by mono F C ( s ) = ∏ b ∈ C [ s ] b . Definition 33. Given a finite factored set F = ( S , B ) , an E ⊆ S , and a C ⊆ B , let monos F C ( E ) ∈ P ( Poly F ) be given by monos F C ( E ) = { mono F C ( s ) ∣ s ∈ E } . Definition 34. Given a finite factored set F = ( S , B ) , an E ⊆ S , and a C ⊆ B , let poly F C ( E ) ∈ Poly F be given by poly F C ( E ) = ∑ m ∈ monos F C ( E ) m . Proposition 26. Let F = ( S , B ) be a finite factored set, and let E ⊆ S . Then Q F E = poly F B ( E ) . Proof. We start by showing that for all s ≠ t ∈ S , mono F B ( s ) ≠ mono F B ( t ) . Let s ≠ t ∈ S be arbitrary. By Proposition 3 , if s ≠ t , there must be some b ∈ B such that [ s ] b ≠ [ t ] b . Then, note that [ s ] b ∈ supp ( mono F B ( s ) ) . If [ s ] b were also in supp ( mono F B ( t ) ) , then t would be in both [ s ] b and [ t ] b , contradicting the fact that these two sets are disjoint. Therefore mono F B ( s ) ≠ mono F B ( t ) . Thus monos F B ( E ) has exactly one element for each element of E , so we have that ∑ m ∈ monos F B ( E ) m = ∑ s ∈ E mono F B ( s ) = Q F E . □ Proposition 27. Let F = ( S , B ) be a finite factored set, and let E 0 , E 1 ⊆ S be subsets of S . Let C 0 , C 1 ⊆ B be disjoint subsets of B . Let E 2 = χ F C 0 ( E 0 , E 1 ) , and let C 2 = C 0 ∪ C 1 . Then poly F C 2 ( E 2 ) = poly F C 0 ( E 0 ) ⋅ poly F C 1 ( E 1 ) . Proof. For i ∈ { 0 , 1 , 2 } , let M i = monos F C i ( E i ) . We will start by showing that f : M 0 × M 1 → M 2 , given by f ( m 0 , m 1 ) = m 0 m 1 , is a well-defined function and a bijection. First, observe that it follows immediately from the definition that for all s 0 , s 1 ∈ S , if s 2 = χ F C 0 ( s 0 , s 1 ) we have that mono F C 0 ( s 0 ) = mono F C 0 ( s 2 ) , mono F C 1 ( s 1 ) = mono F C 1 ( s 2 ) , and mono F C 0 ( s 2 ) ⋅ mono F C 1 ( s 2 ) = mono F C 2 ( s 2 ) . Combining these, we get that mono F C 0 ( s 0 ) ⋅ mono F C 1 ( s 1 ) = mono F C 2 ( χ F C 0 ( s 0 , s 1 ) ) . For all ( m 0 , m 1 ) ∈ M 0 × M 1 , there exists some s 0 ∈ E 0 such that m 0 = mono F C 0 ( s 0 ) , and some s 1 ∈ E 1 such that m 1 = mono F C 1 ( s 1 ) , and this gives us that m 0 m 1 = mono F C 0 ( s 0 ) mono F C 1 ( s 1 ) = mono F C 2 ( χ F C ( s 0 , s 1 ) ) ∈ M 2 . Thus, f is well-defined. To see that f is surjective, observe that for all m 2 ∈ M 2 , there exists an s 2 ∈ E 2 such that m 2 = mono F C 2 ( s 2 ) , and there exist s 0 ∈ E 0 and s 1 ∈ E 1 such that s 2 = χ F C ( s 0 , s 1 ) , and we have f ( mono F C 0 ( s 0 ) , mono F C 1 ( s 1 ) ) = m 2 . To see that f is injective, observe that for i ∈ { 0 , 1 } , for all m i ∈ M i , supp ( m i ) ⊆ ⋃ b ∈ C i b . Further, ⋃ b ∈ C 0 b and ⋃ b ∈ C 1 b are disjoint. Thus, for all m 0 ∈ M 0 and m 1 ∈ M 1 , supp ( m i ) = supp ( m 0 m 1 ) ∩ ⋃ b ∈ C i b . This means that for all m 0 , m ′ 0 ∈ M 0 and m 1 , m ′ 1 ∈ M 1 , if m 0 m 1 = m ′ 0 m ′ 1 , then supp ( m 0 ) = supp ( m ′ 0 ) and supp ( m 1 ) = supp ( m ′ 1 ) . However, every monomial in M 0 or M 1 is just equal to the product of all variables in its support. Thus m 0 = ∏ v ∈ supp ( m 0 ) v = m ′ 0 and m 1 = ∏ v ∈ supp ( m 1 ) v = m ′ 1 . Thus f is injective, and thus a bijection between M 0 × M 1 and M 2 . Now, we have that poly F C 0 ( E 0 ) ⋅ poly F C 1 ( E 1 ) = ⎛ ⎝ ∑ m 0 ∈ M 0 m 0 ⎞ ⎠ ⎛ ⎝ ∑ m 1 ∈ M 1 m 1 ⎞ ⎠ = ∑ m 0 ∈ M 0 ∑ m 1 ∈ M 1 m 0 m 1 = ∑ ( m 0 , m 1 ) ∈ M 0 × M 1 m 0 m 1 = ∑ ( m 0 , m 1 ) ∈ M 0 × M 1 f ( m 0 , m 1 ) = ∑ m 2 ∈ M 2 m 2 = poly F C 2 ( E 2 ) . □ Proposition 28. Let F = ( S , B ) be a finite factored set, and let E be a nonempty subset of S . If p divides Q F E , then p = r ⋅ poly F C ( E ) , for some r ∈ R and C ⊆ B . Proof. Let F = ( S , B ) be a finite factored set, and let E be a nonempty subset of S . Let p , q ∈ Poly F satisfy p q = Q F E . We thus must have supp ( p ) ∪ supp ( q ) = supp ( Q F E ) . If there were some T ∈ supp ( p ) ∩ supp ( q ) , then the degree of T in Q F E would be at least 2, contradicting the definition of Q F E and Corollary 1 . Thus, supp ( p ) ∩ supp ( q ) = { } . There can be no combining like terms, then, in the product p q . The monomial terms in Q F E are in bijective correspondence to the pairs of monomial terms in p and monomial terms in q . In particular, this means that since all the coefficients in p q are equal to 1 , all the coefficients in p must be equal to some r ∈ R , and all of the coefficients in q must be equal to 1 / r . Further, for all b ∈ B , if b ∩ supp ( p ) is nonempty, b ∩ supp ( q ) must be empty, since otherwise Q F E would contain a term with two factors in b , which clearly never happens according to the definition of Q F E . Since E is nonempty, for each b ∈ B there must be some T ∈ b ∩ supp ( Q F E ) . Thus at least one of b ∩ supp ( p ) and b ∩ supp ( q ) must be nonempty, so exactly one of b ∩ supp ( p ) and b ∩ supp ( q ) must be nonempty. Let C be the set of all b ∈ B such that b ∩ supp ( p ) is nonempty. For every b ∈ C , every term of Q F E has exactly one factor in b . Thus, every term in p has exactly one factor in b . These cover all variables in the support of p , so each term in p must have total degree | C | . For each m ∈ monos F C ( E ) , m divides a term in Q F E . Since m has no common support with q , m must also divide a term in p . Thus r ⋅ m must be a term in p . Conversely, every term in p divides a term in Q F E , and thus must be in monos F C ( E ) . Thus every term in p is of the form r ⋅ m for some m ∈ monos F C ( E ) . Thus p = ∑ m ∈ monos F C ( E ) r ⋅ m = r ⋅ poly F C ( E ) . □ 5.2. Factoring Characteristic Polynomials We will now show how to factor characteristic polynomials into irreducibles. Definition 35. Given a finite factored set F = ( S , B ) , and a nonempty subset E ⊆ S , let Irr F ( E ) ⊆ P ( B ) denote the set of all C ⊆ B such that: C is nonempty, χ F C ( E , E ) = E , and there is no nonempty strict subset D ⊂ C such that χ F D ( E , E ) = E . Proposition 29. Let F = ( S , B ) be a finite factored set, and let E be a nonempty subset of S . Then Irr F ( E ) ∈ Part ( B ) . Proof. Let F = ( S , B ) be a finite factored set, and let E be a nonempty subset of S . It suffices to show that the sets in Irr F ( E ) are pairwise disjoint and cover B . We start by showing that the set of all C ⊆ B satisfying χ F C ( E , E ) = E is closed under intersection. Indeed, if χ F C 0 ( E , E ) = E and χ F C 1 ( E , E ) = E , then χ F C 0 ∩ C 1 ( E , E ) = χ F C 0 ( E , χ F C 1 ( E , E ) ) = χ F C 0 ( E , E ) = E . Next, observe that χ F B ( E , E ) = E . Thus, for all b ∈ B , we can consider C b = ⋂ C ⊆ B , b ∈ C , χ F C ( E , E ) = E C . Since C b is an intersection of a finite nonempty collection of sets C satisfying χ F C ( E , E ) = E , we have that χ F C b ( E , E ) = E . Further, b ∈ C b , so C b is nonempty. Assume for the purpose of contradiction that there is some nonempty strict subset D ⊂ C b such that χ F D ( E , E ) = E . If b ∈ D , then we have a contradiction by the definition of C b . If b ∉ D , then note that χ F B ∖ D ( E , E ) = E , so χ F C b ∖ D ( E , E ) = E , and C b ∖ D is a nonempty strict subset of C b that contains b , contradicting the definition of C b . Thus C b ∈ Irr F ( E ) for all b ∈ B , and since b ∈ C b , this means that the sets in Irr F ( E ) cover B . Next, we need to show that the sets in Irr F ( E ) are pairwise disjoint. Let C 0 , C 1 ∈ Irr F ( E ) be arbitrary distinct elements. We have that χ F C 0 ∩ C 1 ( E , E ) = E , and C 0 ∩ C 1 is a subset of C 0 and C 1 , and thus a strict subset of at least one of them. Thus C 0 ∩ C 1 is empty. Thus Irr F ( E ) ∈ Part ( B ) . □ The following two propositions constitute a factorization of Q F E into irreducibles. Proposition 30. Let F = ( S , B ) be a finite factored set, and let E be a nonempty subset of S . Then Q F E = ∏ C ∈ Irr F ( E ) poly F C ( E ) . Proof. Let F = ( S , B ) be a finite factored set, and let E be a nonempty subset of S . Let n = | Irr F ( E ) | , and let Irr F ( E ) = { C 0 , … , C n − 1 } . For 0 ≤ k < n , let C ≤ k = ⋃ k i = 0 C i . We will show by induction on k that ∏ k i = 0 poly F C i ( E ) = poly F C ≤ k ( E ) for all 0 ≤ k < n . If k = 0 , the result is trivial, as ∏ 0 i = 0 poly F C i ( E ) = poly F C 0 ( E ) = poly F C ≤ 0 ( E ) . For k > 0 , observe that C k and C ≤ k − 1 are disjoint, and that E = χ F C k ( E , E ) , thus by Proposition 27, we have poly F C k ( E ) ⋅ poly F C ≤ k − 1 ( E ) = poly F C ≤ k ( E ) . Thus, by induction, we get ∏ k i = 0 poly F C i ( E ) = poly F C ≤ k ( E ) . In the case where k = n − 1 , this gives that ∏ C ∈ Irr F ( E ) poly F C ( E ) = poly F B ( E ) = Q F E . □ Proposition 31. Let F = ( S , B ) be a finite factored set, and let E be a nonempty subset of S . Then poly F C ( E ) is irreducible for all C ∈ Irr F ( E ) . Proof. Let F = ( S , B ) be a finite factored set, let E be a nonempty subset of S , and let C ∈ Irr F ( E ) . Assume for the purpose of contradiction that p 0 ⋅ p 1 = poly F C ( E ) , and that both p 0 and p 1 have nonempty support. By Proposition 28, we have that p i = r i ⋅ poly F C i ( E ) , for some r 0 , r 1 ∈ R , and C 0 , C 1 ⊆ B . We will first need to show that C 0 and C 1 are nonempty and disjoint. They must be nonempty, because p 0 and p 1 have nonempty support. Assume for the purpose of contradiction that b ∈ C 0 ∩ C 1 . Let s be an element of E , and note that for i ∈ { 0 , 1 } , we have [ s ] b ∈ supp poly F C i ( E ) . Thus [ s ] b must be degree at least 2 in poly F C ( E ) , which contradicts the fact that every variable clearly has degree at most 1 in poly F C ( E ) . Next, we need to show that C 0 ∪ C 1 = C . We already know that supp ( poly F C ( E ) ) = supp ( r 0 r 1 poly F C 0 ( E ) poly F C 1 ( E ) ) = supp ( poly F C 0 ( E ) ) ∪ supp ( poly F C 1 ( E ) ) . Let s be an element of E . Given an arbitrary b ∈ B , we have that b ∈ C if and only if [ s ] b ∈ supp ( poly F C ( E ) ) if and only if [ s ] b ∈ supp ( poly F C i ( E ) ) for some i ∈ { 0 , 1 } if and only if b ∈ C 0 ∪ C 1 . We now have that C 0 and C 1 are disjoint and that C = C 0 ∪ C 1 . Thus, by Proposition 27, we have that poly F C 0 ( E ) ⋅ poly F C 1 ( E ) = poly F C ( χ F C 0 ( E , E ) ) . Thus poly F C ( E ) = r 0 r 1 poly F C ( χ F C 0 ( E , E ) ) , so monos F C ( E ) = monos F C ( χ F C 0 ( E , E ) ) . Let s 0 , s 1 ∈ E be arbitrary, and let s 2 = χ F C 0 ( s 0 , s 1 ) . Note that mono F C ( s 2 ) ∈ monos F C ( χ F C 0 ( E , E ) ) = monos F C ( E ) , so there is some s 3 ∈ E such that mono F C ( s 2 ) = mono F C ( s 3 ) . Thus s 2 ∼ b s 3 for all b ∈ C . However, we also have that s 2 ∼ b s 1 for all b ∈ B ∖ C , so s 2 = χ F C ( s 3 , s 1 ) . Since C ∈ Irr F ( E ) , χ F C ( E , E ) = E , so s 2 = χ F C 0 ( s 0 , s 1 ) ∈ E . Since s 0 and s 1 were arbitrary elements of E , we have that χ F C 0 ( E , E ) = E . Since C 0 is a nonempty strict subset of C , this contradicts the fact that C ∈ Irr F ( E ) . Thus, poly F C ( E ) is irreducible for all C ∈ Irr F ( E ) . □ 5.3. Characteristic Polynomials and Orthogonality We can now give an alternate characterization of conditional orthogonality in terms of divisibility of characteristic polynomials. Lemma 3. Let F = ( S , B ) be a finite factored set, and let X , Y , Z ∈ Part ( S ) be partitions of S . The following are equivalent. X ⊥ F Y | Z . Q F z divides Q F x ∩ z ⋅ Q F y ∩ z for all x ∈ X , y ∈ Y , and z ∈ Z . Q F z ⋅ Q F x ∩ y ∩ z = Q F x ∩ z ⋅ Q F y ∩ z for all x ∈ X , y ∈ Y , and z ∈ Z . Proof. Clearly condition 3 implies condition 2. We will first show that condition 1 implies condition 3, and then show that condition 2 implies condition 1. Let F = ( S , B ) , and let X , Y , Z ∈ Part ( S ) satisfy X ⊥ F Y | Z . Consider an arbitrary x ∈ X , y ∈ Y , and z ∈ Z . We want to show that Q F z ⋅ Q F x ∩ y ∩ z = Q F x ∩ z ⋅ Q F y ∩ z . Let C = h F ( X | z ) . Clearly C ⊢ F X | z . We thus have that χ F C ( z , z ) = z , so χ F B ∖ C ( z , z ) = z . We also have that h F ( Y | z ) ⊆ B ∖ C , so Y | z ≤ z ( ⋁ S ( B ∖ C ) ) | z . These two together give that B ∖ C ⊢ F Y | z . Since C ⊢ F X | z , we have that χ F C ( x ∩ z , z ) = x ∩ z . Thus, by Proposition 27, we have that poly F C ( x ∩ z ) ⋅ poly F B ∖ C ( z ) = Q F x ∩ z . Similarly, since B ∖ C ⊢ F Y | z , we have that poly F C ( z ) ⋅ poly F B ∖ C ( y ∩ z ) = Q F y ∩ z . Since χ F C ( x ∩ z , y ∩ z ) ⊆ χ F C ( x ∩ z , z ) = x ∩ z , and χ F C ( x ∩ z , y ∩ z ) ⊆ χ F C ( z , y ∩ z ) = y ∩ z , we have χ F C ( x ∩ z , y ∩ z ) ⊆ x ∩ y ∩ z . We also have that χ F C ( x ∩ z , y ∩ z ) ⊇ χ F C ( x ∩ y ∩ z , x ∩ y ∩ z ) ⊇ x ∩ y ∩ z . Thus χ F C ( x ∩ z , y ∩ z ) = x ∩ y ∩ z . By Proposition 27, this gives that poly F C ( x ∩ z ) ⋅ poly F B ∖ C ( y ∩ z ) = Q F x ∩ y ∩ z . Finally, since χ F C ( z , z ) = z , we have that poly F C ( z ) ⋅ poly F B ∖ C ( z ) = Q F z . Thus, Q F z ⋅ Q F x ∩ y ∩ z and Q F x ∩ z ⋅ Q F y ∩ z are both equal to poly F C ( x ∩ z ) ⋅ poly F B ∖ C ( y ∩ z ) ⋅ poly F C ( z ) ⋅ poly F B ∖ C ( z ) . Thus, condition 1 implies condition 3. It remains to show that condition 2 implies condition 1. Fix F = ( S , B ) , and X , Y , Z ∈ Part ( S ) , and let Q F z divide Q F x ∩ z ⋅ Q F y ∩ z for all x ∈ X , y ∈ Y , and z ∈ Z . Assume for the purpose of contradiction that it is not the case that X ⊥ F Y | Z . Thus, there exists some z ∈ Z such that h F ( X | z ) ∩ h F ( Y | z ) ≠ { } . Let z ∈ Z and b ∈ B satisfy b ∈ h F ( X | z ) ∩ h F ( Y | z ) ≠ { } . Let C ⊆ B be such that b ∈ C and C ∈ Irr F ( z ) , and let p = poly F C ( z ) . Thus, p is an irreducible factor of Q F z . Either p divides Q F x ∩ z for all x ∈ X or p divides Q F y ∩ z for all y ∈ Y , since otherwise there would exist an x ∈ X and a y ∈ Y such that p divides neither Q F x ∩ z nor Q F x ∩ z , but does divide their product, contradicting the fact that p is irreducible, and thus prime. Assume without loss of generality that p divides Q F x ∩ z for all x ∈ X . Fix an x ∈ X . Let us first restrict attention to the case where x ∩ z is nonempty. Let Q F x ∩ z = p ⋅ q . By Proposition 28, p = r 0 ⋅ poly F C 0 ( x ∩ z ) and q = r 1 ⋅ poly F C 1 ( x ∩ z ) for some r 0 , r 1 ∈ R and C 0 , C 1 ⊆ B . We will show that C 0 = C , C 1 = B ∖ C , and r 0 = r 1 = 1 . Let s be an element of x ∩ z . Then for all b ∈ B , b ∈ C if and only if [ s ] b ∈ supp ( p ) if and only if [ s ] b ∈ supp ( poly F C 0 ( x ∩ z ) ) if and only if b ∈ C 0 . Thus C 0 = C . For all b ∈ B ∖ C , we have [ s ] b ∈ supp ( Q F x ∩ z ) and [ s ] b ∉ supp ( p ) , so [ s ] b ∈ supp ( q ) , so b ∈ C 1 . Similarly, for all b ∈ C 1 , [ s ] b ∈ supp ( q ) , so [ s ] b ∉ supp ( p ) , so b ∈ B ∖ C . Thus C 1 = B ∖ C . Since p and poly F C 0 ( x ∩ z ) both have all coefficients equal to 1 , we have r 0 = 1 . Thus, p = poly F C ( x ∩ z ) . Similarly, since all the coefficients of p are 1 and all the coefficients of Q F x ∩ z are 1 , all the coefficients of q are 1 , so r 1 = 1 . Thus, q = poly F B ∖ C ( x ∩ z ) . We thus have that Q F x ∩ z = poly F C ( z ) ⋅ poly F B ∖ C ( x ∩ z ) . In the case where x ∩ z is empty, we also have Q F x ∩ z = poly F C ( z ) ⋅ poly F B ∖ C ( x ∩ z ) , since both sides are 0 . By Proposition 27, Q F x ∩ z = poly F B ( χ F C ( z , x ∩ z ) ) . Thus, monos F B ( x ∩ z ) = monos F B ( χ F C ( z , x ∩ z ) ) , so x ∩ z = χ F C ( z , x ∩ z ) = χ F B ∖ C ( x ∩ z , z ) . Since x ∩ z = χ F B ∖ C ( x ∩ z , z ) for all x ∈ X , we have that B ∖ C ⊢ F X | z . However, this contradicts the fact that b ∉ B ∖ C , and b ∈ h F ( X | z ) . Thus, condition 2 implies condition 1. □ 5.4. Probability Distributions on Finite Factored Sets The primary purpose of all this discussion of characteristic polynomials has been to build up to thinking about the relationship between orthogonality and probabilistic independence. We will now discuss probability distributions on finite factored sets. Recall the definition of a probability distribution. Definition 36. Given a finite set S , a probability distribution on S is a function P : P ( S ) → R such that P ( E ) ≥ 0 for all E ⊆ S , P ( { } ) = 0 , P ( S ) = 1 , and P ( E 0 ∪ E 1 ) = P ( E 0 ) + P ( E 1 ) whenever E 0 , E 1 ⊆ S satisfy E 0 ∩ E 1 = { } . A probability distribution on a finite factored set F is a probability distribution on its underlying set that also satisfies another condition, which represents the probability distribution coming from a product of distributions on the underlying factors. Definition 37. Given a finite factored set F = ( S , B ) , a probability distribution on F is a probability distribution P on S such that for all s ∈ S , we have P ( { s } ) = ∏ b ∈ B P ( [ s ] b ) . Proposition 32. Given a finite factored set F = ( S , B ) , a probability distribution on S is a probability distribution P on F if and only if P ( E ) = Q F E ( P ) for all E ⊆ S . Proof. If P ( E ) = Q F E ( P ) for all E ⊆ S , in particular this means that P ( { s } ) = Q F { s } ( P ) = ( ∏ b ∈ B [ s ] b ) ( P ) = ∏ b ∈ B P ( [ s ] b ) for all s ∈ S . Conversely, if P ( { s } ) = ∏ b ∈ B P ( [ s ] b ) for all s ∈ S , then for all E ⊆ S , P ( E ) = ∑ s ∈ E ∏ b ∈ B P ( [ s ] b ) = ( ∑ s ∈ E ∏ b ∈ B [ s ] b ) ( P ) = Q F E ( P ) . □ 5.5. The Fundamental Theorem of Finite Factored Sets We are now ready to state and prove the fundatmental theorem of finite factored sets. Theorem 3. Let F = ( S , B ) be a finite factored set, and let X , Y , Z ∈ Part ( S ) be partitions of S . Then X ⊥ F Y | Z if and only if for all probability distributions P on F and all x ∈ X , y ∈ Y , and z ∈ Z , we have P ( x ∩ z ) ⋅ P ( y ∩ z ) = P ( x ∩ y ∩ z ) ⋅ P ( z ) . Proof. We already have by Lemma 3 that if X ⊥ F Y | Z , then for all x ∈ X , y ∈ Y , and z ∈ Z , Q F z ⋅ Q F x ∩ y ∩ z = Q F x ∩ z ⋅ Q F y ∩ z . Thus for any probability distribution P on F , we have P ( z ) ⋅ P ( x ∩ y ∩ z ) = Q F z ( P ) ⋅ Q F x ∩ y ∩ z ( P ) = Q F x ∩ z ( P ) ⋅ Q F y ∩ z ( P ) = P ( x ∩ z ) ⋅ P ( y ∩ z ) . Conversely, assume that for all probability distributions P on F , and all x ∈ X , y ∈ Y , and z ∈ Z , we have P ( x ∩ z ) ⋅ P ( y ∩ z ) = P ( x ∩ y ∩ z ) ⋅ P ( z ) . If S is empty, then { } is the unique partition of S , and we have { } ⊥ F { } | { } . Thus, we can restrict our attention to the case where S is nonempty. Fix an arbitrary x ∈ X , y ∈ Y , and z ∈ Z . Let q = Q F x ∩ z ⋅ Q F y ∩ z − Q F x ∩ y ∩ z ⋅ Q F z . We will first show that q ( f ) = 0 for all f : P ( S ) → R > 0 . Given an arbitrary f : P ( S ) → R > 0 , we can define P f : P ( S ) → R by P f ( E ) = Q F E ( f ) / Q F S ( f ) , and we will show that P f is a distribution on F . P f is well-defined because Q F S ( f ) is a nonempty sum of products of positive real numbers, and thus positive. Further, since Q F E ( f ) is a sum of products of positive real numbers, P f ( E ) ≥ 0 for all E ⊆ S . Since Q F { } = 0 , we also have P f ( { } ) = 0 . Clearly P f ( S ) = 1 . Finally, for all E 0 , E 1 ⊆ S with E 0 ∩ E 1 = { } , we have P f ( E 0 ∪ E 1 ) = Q F E 0 ∪ E 1 ( f ) / Q F S ( f ) = ( Q F E 0 ( f ) + Q F E 1 ( f ) ) / Q F S ( f ) = P f ( E 0 ) + P f ( E 1 ) . Therefore P f is a distribution on S . We still need to show that P f is a distribution on F . Observe that for all s ∈ S and b ∈ B , since χ F { b } ( [ s ] b , S ) = [ s ] b , we have that Q F [ s ] b ( f ) = poly F { b } ( [ s ] b ) ⋅ poly F B ∖ { b } ( S ) , and since χ F { b } ( S , S ) = S , we have that Q F S ( f ) = poly F { b } ( S ) ⋅ poly F B ∖ { b } ( S ) . Thus, we have that P f ( [ s ] b ) = poly F { b } ( [ s ] b ) ( f ) / poly F { b } ( S ) ( f ) = f ( [ s ] b ) / poly F { b } ( S ) ( f ) . Thus, for all s ∈ S , ∏ b ∈ B P f ( [ s ] b ) = ( ∏ b ∈ B f ( [ s ] b ) ) / ( ∏ b ∈ B poly F { b } ( S ) ( f ) ) = Q F { s } ( f ) / Q F S ( f ) = P f ( { s } ) . Thus P f is a distribution on F . It follows that P f ( x ∩ z ) ⋅ P f ( y ∩ z ) = P f ( x ∩ y ∩ z ) ⋅ P f ( z ) . We therefore have that q ( f ) = Q F x ∩ z ( f ) ⋅ Q F y ∩ z ( f ) − Q F x ∩ y ∩ z ( f ) ⋅ Q F z ( f ) = ( P f ( x ∩ z ) ⋅ P f ( y ∩ z ) − P f ( x ∩ y ∩ z ) ⋅ P f ( z ) ) ⋅ Q F S ( f ) 2 = 0 ⋅ Q F S ( f ) 2 = 0. Thus, q is a polynomial that is zero on an open subset of inputs, so q is the zero polynomial. Thus Q F x ∩ z ⋅ Q F y ∩ z − Q F z ⋅ Q F x ∩ y ∩ z = 0 , so Q F z ⋅ Q F x ∩ y ∩ z = Q F x ∩ z ⋅ Q F y ∩ z . Since x ∈ X , y ∈ Y , and z ∈ Z were arbitrary, by Lemma 3, we have X ⊥ F Y | Z . □ In the next two posts, we will introduce temporal inference using finite factored sets, and discuss future potential research directions.