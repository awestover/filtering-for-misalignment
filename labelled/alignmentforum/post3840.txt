%&latex % operators that are separated from the operand by a space % operators that require brackets % operators that require parentheses % Paper specific This post continues the research programme of attacking the grain of truth problem by departure from the Bayesian paradigm. In the previous post , I suggested using Savage's minimax regret decision rule, but here I fall back to the simple minimax decision rule. This is because the mathematics is considerably simpler, and minimax should be sufficient to get IUD play in general games and Nash equilibrium in zero-sum two-player games. I hope to build on these results to get analogous results for minimax regret in the future. We consider "semi-Bayesian" agents following the minimax expected utility decision rule, in oblivious environments with full monitoring (a setting that we will refer to as "forecasting"). This setting is considered in order to avoid the need to enforce exploration, as a preparation for analysis of general environments. We show that such agents satisfy a certain asymptotic optimality theorem. Intuitively, this theorem means that whenever the environment satisfies an incomplete model that is included in the prior, the agent will eventually learn this model i.e. extract at least as much utility as can be guaranteed for this model. Appendix A contains the proofs of all results. Appendix B contains some theorems from the literature together with a corollary used in Appendix A. ##Notation Given X a topological space, P ( X ) will denote the space of Borel probability measures on X . We regard it as a topological space using the weak ∗ topology. Given x ∈ X , δ x ∈ P ( X ) is defined by δ x ( A ) : = [ [ x ∈ A ] ] . Given μ , ν ∈ P ( X ) , d tv ( μ , ν ) stands for the total variation distance between μ and ν . We denote P C ( X ) the set of non-empty convex compact subsets of P ( X ) . Given X a finite set, X ∗ denotes the set of finite strings in alphabet X , i.e. X ∗ : = ⨆ n ∈ N X n . X ω denotes the set of infinite strings in alphabet X . Given x ∈ X ∗ ⊔ X ω , | x | ∈ N ⊔ { ∞ } is the length of string. Given 0 ≤ n < | x | , x n ∈ X is the n -th symbol in x . Given 0 ≤ n ≤ | x | , x < n is the prefix of x of length n . Given x , y ∈ X ∗ ⊔ X ω , the notations x ⊏ y , x ⊑ y , x ⊏ / y and x ⋢ y mean " x is a proper prefix of y ", " x is a prefix of y " and their negations. λ X ∈ X ∗ is the empty string and X + : = X ∗ ∖ λ X . ##Elementary properties of minimax Fix S and E compact Polish spaces, S representing the agent's pure policies and E representing the pure environments. Let u : S × E → R be a continuous utility function. #Proposition 1 Consider Φ ⊆ P ( E ) . There exists π ∗ ∈ a r g m a x π ∈ P ( S ) inf μ ∈ Φ E π × μ [ u ] Moreover, let ¯ Φ be the closure of the convex hull of Φ . Then, the same π ∗ satisfies π ∗ ∈ a r g m a x π ∈ P ( S ) min μ ∈ ¯ Φ E π × μ [ u ] We will say that such a π ∗ is a minimax policy for Φ . #Proposition 2 Consider Φ , Φ ′ ∈ P C ( E ) and p ∈ [ 0 , 1 ] . Then, there is ν ∗ ∈ Φ ′ s.t. any minimax policy for p Φ + ( 1 − p ) Φ ′ is a minimax policy for p Φ + ( 1 − p ) ν ∗ . In particular, Proposition 2 implies that a minimax policy for Φ is the optimal policy for some μ ∗ ∈ Φ . Now we ask what policy is implemented by "subagents" created by a minimax policy. Suppose S = S 1 × S 2 , where S 2 represents the pure policies of the subagent. Assume that there is a Borel set A ⊆ E (the condition for the creation of the subagent), a finite set T (the actions taken before the creation of the subagent), a Borel measurable mapping α : S 1 → T and continuous functions u 1 : S 1 × E → R and u 2 : S 2 × T × E → R s.t. u ( s 1 , s 2 , e ) = u 1 ( s 1 , e ) + χ A ( e ) u 2 ( s 2 , α ( s 1 ) , e ) Consider Φ ∈ P C ( E ) and π ∗ ∈ P ( S ) minimax for Φ . Denote pr 1 , 2 : S → S 1 , 2 the projection mappings. Define π ∗ 1 ∈ P ( S 1 ) by π ∗ 1 : = pr 1 ∗ π ∗ Define π ∗ 2 : T → P ( S 2 ) by π ∗ 2 ( t ) : = pr 2 ∗ ( π ∗ ∣ α − 1 ( t ) × S 2 ) If for some t 0 ∈ T we have π ∗ ( α − 1 ( t 0 ) × S 2 ) = 0 , then π ∗ 2 ( t 0 ) can be arbitrary. #Proposition 3 π ∗ 2 ∈ a r g m a x π 2 : T → P ( S 2 ) min μ ∈ Φ ( E π ∗ 1 × μ [ u 1 ] + μ ( A ) E t ∼ α ∗ π ∗ 1 [ E π 2 ( t ) × μ ∣ A [ u 2 ( t ) ] ] ) It should also be possible to make do without T and the associated decomposition of u by instead decomposing π ∗ into π ∗ 1 and a Markov kernel from S 1 to S 2 . ##Asymptotic optimality Fix finite sets A (actions) and O (observations). We now assume that E = O ω and S = O ∗ → A with the product topology. We fix γ : N → R ≥ 0 a time discount function satisfying ∑ n γ ( n ) < ∞ and r : ( A × O ) ∗ → R a bounded reward function. Given e ∈ O ∗ and s : O ∗ → A , we define e s ∈ ( A × O ) ω by e s n : = ( s ( e < n ) , e n ) The utility function is then given by u ( s , e ) = ∑ n ∈ N γ ( n ) r ( e s < n ) We will need a notation for a combination of two policies where the agent switches from one to another when observing some x ∈ O ∗ . Given s 1 : O ∗ → A and s 2 : O ∗ → A , we define s 1 × x s 2 : O ∗ → A by ( s 1 × x s 2 ) ( y ) : = { s 1 ( y ) if y ⋣ x s 2 ( z ) if y = x z Consider any π ∈ P ( O ∗ → A ) and ρ : A | x | → P ( O ∗ → A ) . We define π ⊗ x ρ ∈ P ( O ∗ → A ) as follows. For any Borel measurable B ⊆ O ∗ → A : ( π ⊗ x ρ ) ( B ) : = ∑ t ∈ A | x | Pr s 1 ∼ π s 2 ∼ ρ ( t ) [ s 1 × x s 2 ∈ B ∧ ∀ n < | x | : t n = s 1 ( x < n ) ] It is easy to see the above indeed defines a probability measure. Note that changing the policy after a certain event cannot change utility more than O ( 1 ) times the probability of the event times the corresponding time discount factor. That is, we have the following: #Proposition 4 | E ( π ⊗ x ρ ) × μ [ u ] − E π × μ [ u ] | ≤ ( sup r − inf r ) Pr e ∼ μ [ x ⊏ e ] ∑ n > | x | γ ( n ) We are now ready to formulate the optimality theorem. Consider Φ , Φ ′ ∈ P C ( O ω ) and p ∈ ( 0 , 1 ] . Denote Ψ = p Φ + ( 1 − p ) Φ ′ . We think of Ψ as the prior, Φ as one of the models in the prior (assigned probability p ) and Φ ′ as the convex combination of all other models. Let π ∗ ∈ P ( O ∗ → A ) be a minimax policy for Ψ . Define v : O ∗ → R by v ( x ) : = max ρ ∈ A | x | → P ( O ∗ → A ) min μ ∈ Φ E ( π ∗ ⊗ x ρ ) × μ [ u ] That is, v is the expected utility that can be guaranteed by changing the policy following x , assuming that the true environment is in Φ . We claim that if the true environment is in Φ , then after sufficient time π ∗ will achieve at least as much utility as can be guaranteed for Φ (guaranteed under the constraint of following π ∗ until the point of making the current observations). That is, v can only be greater than E π ∗ × μ [ u ] by a quantity that goes to 0 with probability 1, even after normalizing according to Proposition~5: #Theorem 1 ∀ μ ∈ Φ : Pr e ∼ μ [ lim n → ∞ max ( v ( e < n ) − E π ∗ × μ [ u ] Pr e ′ ∼ μ [ e < n ⊏ e ′ ] ∑ m > n γ ( m ) , 0 ) = 0 ] = 1 ##Appendix A We will repeatedly use the standard fact that, given X a compact Polish space, P ( X ) is also a compact Polish space (it is metrizable by the Levy-Prokhorov metric, compact as a consequence of the Banach-Alaoglu theorem and the fact that any probability measure on a Polish space is Radon, and separability is also not hard to prove). #Proposition A.1 Consider X , Y compact Polish spaces, f : X × Y → R continuous, x ∞ ∈ X and a sequence x n → x ∞ . Define g n : Y → R by g n ( y ) : = f ( x n , y ) and g ∞ : Y → R by g ∞ ( y ) : = f ( x ∞ , y ) . Then, g n converges to g ∞ uniformly. #Proof of Proposition A.1 Assume to the contrary that there is ϵ > 0 and a subsequence { x ′ n ∈ X } n ∈ N of { x n } s.t. max y ∈ Y | f ( x ′ n , y ) − f ( x ∞ , y ) | > ϵ This implies we can choose { y n ∈ Y } n ∈ N s.t. | f ( x ′ n , y n ) − f ( x ∞ , y n ) | > ϵ . Let { n k ∈ N } k ∈ N be an increasing sequence s.t. y n k → y ∞ for some y ∞ ∈ Y . We get | f ( x ′ n k , y n k ) − f ( x ∞ , y n k ) | > ϵ , which is a contradiction because f ( x ′ n k , y n k ) → f ( x ∞ , y ∞ ) and f ( x ∞ , y n k ) → f ( x ∞ , y ∞ ) . #Proposition A.2 Consider X , Y compact Polish spaces and f : X × Y → R continuous. Define ϕ : X × P ( Y ) → R by ϕ ( x , ν ) : = E y ∼ ν [ f ( x , y ) ] Then, ϕ is continuous. #Proof of Proposition A.2 Consider any x ∞ ∈ X , ν ∞ ∈ P ( Y ) and sequences x n → x ∞ , ν n → ν ∞ . We have ϕ ( x n , ν n ) − ϕ ( x ∞ , ν ∞ ) = E y ∼ ν n [ f ( x n , y ) − f ( x ∞ , y ) ] + E y ∼ ν n [ f ( x ∞ , y ) ] − E y ∼ ν ∞ [ f ( x ∞ , y ) ] On the right hand side, the first term goes to 0 by Proposition A.1 and the second term goes to 0 by definition of the weak* topology. #Proposition A.3 Consider any X , Y compact Polish and f : X × Y → R continuous. Define F : P ( X ) × P ( Y ) → R by F ( μ , ν ) : = E μ × ν [ f ] Then, F is continuous. #Proof of Proposition A.3 Follows by applying Fubini's theorem and using Proposition A.2 twice. #Proposition A.4 Consider any X , Y compact Polish, A ⊆ Y and f : X × Y → R continuous. Define f A : X → R by f A ( x ) : = inf y ∈ A f ( x , y ) . Then, f A is continuous. #Proof of Proposition A.4 Consider any x ∞ ∈ X and a sequence x n → x ∞ | inf y ∈ A f ( x n , y ) − inf y ∈ A f ( x ∞ , y ) | ≤ sup y ∈ A | f ( x n , y ) − f ( x ∞ , y ) | By Proposition A.1, the right hand converges to 0, therefore the left hand side also converges to 0. In the following, we will use the notation U : P ( S ) × P ( E ) → R , defined by U ( π , μ ) : = E π × μ [ u ] . By Proposition A.3, U is continuous. #Proof of Proposition 1 Define U Φ : P ( S ) → R by U Φ ( π ) : = inf μ ∈ Φ U ( π , μ ) . By Proposition A.4, U Φ is continuous and therefore, π ∗ exists. U is continuous and affine in the 2nd argument (i.e. it sends convex linear combinations to convex linear combinations), and therefore inf μ ∈ Φ U ( π , μ ) = min μ ∈ ¯ Φ U ( π , μ ) , implying the second part of the proposition. #Proof of Proposition 2 Define V : P ( E ) → R by V ( μ ) : = max π ∈ P ( S ) U ( π , μ ) = max s ∈ S U ( δ s , μ ) . Denote Ψ : = p Φ + ( 1 − p ) Φ ′ . By Proposition A.4, V is continuous and therefore, there exists ξ ∗ ∈ a r g m i n μ ∈ Ψ V ( μ ) Choose μ ∗ ∈ Φ , ν ∗ ∈ Φ ′ s.t. ξ ∗ = p μ ∗ + ( 1 − p ) ν ∗ . P ( S ) and Ψ are compact convex sets in the spaces of finite signed Borel measures on S and E respectively. Therefore, we can apply the minimax theorem to get max π ∈ P ( S ) min ξ ∈ Ψ U ( π , ξ ) = min ξ ∈ Ψ max s ∈ S U ( δ s , ξ ) Denote the above number u ∗ . We have min μ ∈ Φ U ( π ∗ , p μ + ( 1 − p ) ν ∗ ) ≥ min ξ ∈ Ψ U ( π ∗ , ξ ) = u ∗ On the other hand max π ∈ P ( S ) min μ ∈ Φ U ( π , p μ + ( 1 − p ) ν ∗ ) ≤ max π ∈ P ( S ) U ( π , ξ ∗ ) = u ∗ Combining the inequalities, we get the desired result. #Definition A.1 In the setting of Proposition 3, consider any π 1 ∈ P ( S 1 ) and π 2 : T → P ( S 2 ) . We define π 1 ⊗ α π 2 ∈ P ( S 1 × S 2 ) as follows. For any Borel measurable B ⊆ S 1 × S 2 : ( π 1 ⊗ α π 2 ) ( B ) : = ∑ t ∈ T ( π 1 × π 2 ( t ) ) ( B ∩ ( α − 1 ( t ) × S 2 ) ) It is easy to see the above indeed defines a probability measure. #Proposition A.5 Consider any π 1 ∈ P ( S 1 ) and π 2 : T → P ( S 2 ) and f : S 1 × S 2 → R Borel measurable and bounded. Then: E π 1 ⊗ α π 2 [ f ] = E s 1 ∼ π 1 [ E s 2 ∼ π 2 ( α ( s 1 ) ) [ f ( s 1 , s 2 ) ] ] #Proof of Proposition A.5 E π 1 ⊗ α π 2 [ f ] = ∑ t ∈ T ∫ α − 1 ( t ) × S 2 f ( s 1 , s 2 ) d ( π 1 × π 2 ( t ) ) ( s 2 ) E π 1 ⊗ α π 2 [ f ] = ∑ t ∈ T ∫ α − 1 ( t ) ∫ S 2 f ( s 1 , s 2 ) d π 2 ( t ) ( s 2 ) d π 1 ( s 1 ) E π 1 ⊗ α π 2 [ f ] = ∑ t ∈ T ∫ α − 1 ( t ) E s 2 ∼ π 2 ( t ) [ f ( s 1 , s 2 ) ] d π 1 ( s 1 ) E π 1 ⊗ α π 2 [ f ] = ∑ t ∈ T ∫ α − 1 ( t ) E s 2 ∼ π 2 ( α ( s 1 ) ) [ f ( s 1 , s 2 ) ] d π 1 ( s 1 ) E π 1 ⊗ α π 2 [ f ] = ∫ S 1 E s 2 ∼ π 2 ( α ( s 1 ) ) [ f ( s 1 , s 2 ) ] d π 1 ( s 1 ) E π 1 ⊗ α π 2 [ f ] = E s 1 ∼ π 1 [ E s 2 ∼ π 2 ( α ( s 1 ) ) [ f ( s 1 , s 2 ) ] ] #Proposition A.6 Given π 1 ∈ P ( S 1 ) , π 2 : T → P ( S 2 ) and μ ∈ P ( E ) U ( π 1 ⊗ α π 2 , μ ) = E π 1 × μ [ u 1 ] + μ ( A ) E t ∼ α ∗ π 1 [ E π 2 ( t ) × μ ∣ A [ u 2 ( t ) ] ] #Proof of Proposition A.6 Applying Proposition A.5: U ( π 1 ⊗ α π 2 , μ ) = E s 1 ∼ π 1 [ E s 2 ∼ π 2 ( α ( s 1 ) ) [ E e ∼ μ [ u 1 ( s 1 , e ) + χ A ( e ) u 2 ( s 2 , α ( s 1 ) , e ) ] ] ] U ( π 1 ⊗ α π 2 , μ ) = E π 1 × μ [ u 1 ] + E s 1 ∼ π 1 [ E s 2 ∼ π 2 ( α ( s 1 ) ) [ μ ( A ) E e ∼ μ ∣ A [ u 2 ( s 2 , α ( s 1 ) , e ) ] ] ] U ( π 1 ⊗ α π 2 , μ ) = E π 1 × μ [ u 1 ] + μ ( A ) E t ∼ α ∗ π 1 [ E π 2 ( t ) × μ ∣ A [ u 2 ( t ) ] ] #Proposition A.7 Consider any π ∈ P ( S 1 × S 2 ) . Define π 1 ∈ P ( S 1 ) and π 2 : T → P ( S 2 ) by π 1 : = pr 1 ∗ π π 2 ( t ) : = pr 2 ∗ ( π ∣ α − 1 ( t ) × S 2 ) If for some t 0 ∈ T we have π ( α − 1 ( t 0 ) × S 2 ) = 0 , then π 2 ( t 0 ) can be arbitrary. Then, ∀ μ ∈ P ( E ) : U ( π , μ ) = U ( π 1 ⊗ α π 2 , μ ) #Proof of Proposition A.7 U ( π , μ ) = E ( s 1 , s 2 ) ∼ π e ∼ μ [ u 1 ( s 1 , e ) + χ A ( e ) u 2 ( s 2 , α ( s 1 ) , e ) ] U ( π , μ ) = E π 1 × μ [ u 1 ] + μ ( A ) E ( s 1 , s 2 ) ∼ π e ∼ μ ∣ A [ u 2 ( s 2 , α ( s 1 ) , e ) ] U ( π , μ ) = E π 1 × μ [ u 1 ] + μ ( A ) ∑ t ∈ T Pr ( s 1 , s 2 ) ∼ π [ α ( s 1 ) = t ] E ( s 1 , s 2 ) ∼ π ∣ α − 1 ( t ) × S 2 e ∼ μ ∣ A [ u 2 ( s 2 , t , e ) ] U ( π , μ ) = E π 1 × μ [ u 1 ] + μ ( A ) E t ∼ α ∗ π 1 [ E π 2 ( t ) × μ ∣ A [ u 2 ( t ) ] ] Applying Proposition A.6, we get the desired result. #Proof of Proposition 3 Consider any π 2 : T → P ( S 2 ) . By definition of π ∗ min μ ∈ Φ U ( π ∗ 1 ⊗ α π 2 , μ ) ≤ min μ ∈ Φ U ( π ∗ , μ ) Applying Proposition A.7 to the right hand side min μ ∈ Φ U ( π ∗ 1 ⊗ α π 2 , μ ) ≤ min μ ∈ Φ U ( π ∗ 1 ⊗ α π ∗ 2 , μ ) Applying Proposition A.6 to both sides, we get the desired result. Given any x ∈ O ∗ , we denote x O ω : = { x y ∣ y ∈ O ω } and ¯ x O ω : = O ω ∖ x O ω . #Proof of Proposition 4 We have E π × μ [ u ] = μ ( x O ω ) E π × μ ∣ x O ω [ u ] + ( 1 − μ ( x O ω ) ) E π × μ ∣ ¯ x O ∗ [ u ] E ( π ⊗ x ρ ) × μ [ u ] = μ ( x O ω ) E ( π ⊗ x ρ ) × μ ∣ x O ω [ u ] + ( 1 − μ ( x O ω ) ) E π × μ ∣ ¯ x O ω [ u ] E ( π ⊗ x ρ ) × μ [ u ] − E π × μ [ u ] = μ ( x O ω ) ( E ( π ⊗ x ρ ) × μ ∣ x O ω [ u ] − E π × μ ∣ x O ω [ u ] ) Denote u 1 ( s , e ) : = ∑ n ≤ | x | γ ( n ) r ( e s < n ) , u 2 ( s , e ) : = ∑ n > | x | γ ( n ) r ( e s < n ) . We have E π × μ ∣ x O ω [ u ] = E π × μ ∣ x O ω [ u 1 ] + E π × μ ∣ x O ∗ [ u 2 ] E ( π ⊗ x ρ ) × μ ∣ x O ω [ u ] = E π × μ ∣ x O ω [ u 1 ] + E ( π ⊗ x ρ ) × μ ∣ x O ω [ u 2 ] E ( π ⊗ x ρ ) × μ [ u ] − E π × μ [ u ] = μ ( x O ω ) ( E ( π ⊗ x ρ ) × μ ∣ x O ω [ u 2 ] − E π × μ ∣ x O ω [ u 2 ] ) The desired result now follows from ( inf r ) ∑ n > | x | γ ( n ) ≤ u 2 ≤ ( sup r ) ∑ n > | x | γ ( n ) . #Definition A.2 A splitting of ( S , E , u ) is ( S 1 , S 2 , A , T , α , u 1 , u 2 ) s.t. S ≅ S 1 × S 2 , A ⊆ E is Borel, T is a finite set, α : S 1 → T is Borel measurable, u 1 : S 1 × E → R and u 2 : S 2 × T × E → R are continuous and u ( s 1 , s 2 , e ) = u 1 ( s 1 , e ) + χ A ( e ) u 2 ( s 2 , α ( s 1 ) , e ) #Proposition A.8 Consider Φ ∈ P C ( E ) , ν ∗ ∈ P ( E ) and p ∈ [ 0 , 1 ] , and denote Ψ : = p Φ + ( 1 − p ) ν ∗ . Suppose that ( S 1 , S 2 , A , T , α , u 1 , u 2 ) is a splitting of ( S , E , u ) . Assume ν ∗ ( A ) > 0 . Fix π ∈ P ( S 1 ) .  Let ρ ∗ : T → P ( S 2 ) satisfy ρ ∗ ∈ a r g m a x ρ : T → P ( S 2 ) min ξ ∈ Ψ U ( π ⊗ α ρ , ξ ) Denote Γ : = sup u 2 − inf u 2 . Then, for any μ 0 ∈ Φ s.t. μ 0 ( A ) > 0 U ( π ⊗ α ρ ∗ , μ 0 ) ≥ max ρ : T → P ( S 2 ) min μ ∈ Φ U ( π ⊗ α ρ , μ ) − 2 Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) #Proof of Proposition A.8 Let τ ∗ : T → P ( S 2 ) satisfy τ ∗ ∈ a r g m a x ρ : T → P ( S 2 ) min μ ∈ Φ U ( π ⊗ α ρ , μ ) Denote u ∗ : = min μ ∈ Φ U ( π ⊗ α τ ∗ , μ ) . Consider any μ ∈ Φ and denote ξ : = p μ + ( 1 − p ) ν ∗ . We have U ( π ⊗ α τ ∗ , ξ ) = p U ( π ⊗ α τ ∗ , μ ′ ) + ( 1 − p ) U ( π ⊗ α τ ∗ , ν ∗ ) U ( π ⊗ α τ ∗ , ξ ) ≥ p u ∗ + ( 1 − p ) U ( π ⊗ α τ ∗ , ν ∗ ) Applying Proposition A.6 to the right hand side U ( π ⊗ α τ ∗ , ξ ) ≥ p u ∗ + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) E t ∼ α ∗ π [ E τ ∗ ( t ) × ν ∗ [ u 2 ∣ A ] ] ) U ( π ⊗ α τ ∗ , ξ ) ≥ p u ∗ + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) ( E t ∼ α ∗ π [ E τ ∗ ( t ) × μ 0 [ u 2 ∣ A ] ] − Γ d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) ) Also, we have U ( π ⊗ α τ ∗ , μ 0 ) ≥ u ∗ Applying Proposition A.6 again E π × μ 0 [ u 1 ] + μ 0 ( A ) E t ∼ α ∗ π [ E τ ∗ ( t ) × μ 0 [ u 2 ∣ A ] ] ≥ u ∗ E t ∼ α ∗ π [ E τ ∗ ( t ) × μ 0 [ u 2 ∣ A ] ] ≥ u ∗ − E π × μ 0 [ u 1 ] μ 0 ( A ) Combining the inequalities U ( π ⊗ α τ ∗ , ξ ) ≥ p u ∗ + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) ( u ∗ − E π × μ 0 [ u 1 ] μ 0 ( A ) − Γ d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) ) U ( π ⊗ α τ ∗ , ξ ) ≥ p u ∗ + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) μ 0 ( A ) ( u ∗ − E π × μ 0 [ u 1 ] − Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) ) U ( π ⊗ α τ ∗ , ξ ) ≥ ( p + ( 1 − p ) ν ∗ ( A ) μ 0 ( A ) ) u ∗ + ( 1 − p ) ( E π × ν ∗ [ u 1 ] − ν ∗ ( A ) μ 0 ( A ) ( E π × μ 0 [ u 1 ] + Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) ) The above inequality holds for any ξ , therefore min ξ ∈ Ψ U ( π ⊗ α τ ∗ , ξ ) ≥ ( p + ( 1 − p ) ν ∗ ( A ) μ 0 ( A ) ) u ∗ + ( 1 − p ) ( E π × ν ∗ [ u 1 ] − ν ∗ ( A ) μ 0 ( A ) ( E π × μ 0 [ u 1 ] + Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) ) By definition of ρ ∗ , it follows that min ξ ∈ Ψ U ( π ⊗ α ρ ∗ , ξ ) ≥ ( p + ( 1 − p ) ν ∗ ( A ) μ 0 ( A ) ) u ∗ + ( 1 − p ) ( E π × ν ∗ [ u 1 ] − ν ∗ ( A ) μ 0 ( A ) ( E π × μ 0 [ u 1 ] + Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) ) Denote ξ 0 : = p μ 0 + ( 1 − p ) ν ∗ and u : = U ( π ⊗ α ρ ∗ , μ 0 ) . We have U ( π ⊗ α ρ ∗ , ξ 0 ) = p u + ( 1 − p ) U ( π ⊗ α ρ ∗ , ν ∗ ) Applying Proposition A.6 to the right hand side U ( π ⊗ α ρ ∗ , ξ 0 ) = p u + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) E t ∼ α ∗ π [ E ρ ∗ ( t ) × ν ∗ [ u 2 ∣ A ] ] ) U ( π ⊗ α ρ ∗ , ξ 0 ) ≤ p u + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) ( E t ∼ α ∗ π [ E ρ ∗ ( t ) × μ 0 [ u 2 ∣ A ] ] + Γ d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) On the other hand, Proposition A.6 implies that E π × μ 0 [ u 1 ] + μ 0 ( A ) E t ∼ α ∗ π [ E ρ ∗ ( t ) × μ 0 [ u 2 ∣ A ] ] = u E t ∼ α ∗ π [ E ρ ∗ ( t ) × μ 0 [ u 2 ∣ A ] ] = u − E π × μ 0 [ u 1 ] μ 0 ( A ) Substituting in the inequality, we get U ( π ⊗ α ρ ∗ , ξ 0 ) ≤ p u + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) ( u − E π × μ 0 [ u 1 ] μ 0 ( A ) + Γ d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) U ( π ⊗ α ρ ∗ , ξ 0 ) ≤ p u + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) μ 0 ( A ) ( u − E π × μ 0 [ u 1 ] + Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) U ( π ⊗ α ρ ∗ , ξ 0 ) ≤ ( p + ( 1 − p ) ν ∗ ( A ) μ 0 ( A ) ) u + ( 1 − p ) ( E π × ν ∗ [ u 1 ] − ν ∗ ( A ) μ 0 ( A ) ( E π × μ 0 [ u 1 ] − Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) Observing that U ( π ⊗ α ρ ∗ , ξ 0 ) ≥ min ξ ∈ Ψ U ( π ⊗ α ρ ∗ , ξ ) we can combine the inequalities, we get ( p + ( 1 − p ) ν ∗ ( A ) μ 0 ( A ) ) ( u − u ∗ ) ≥ 2 ( 1 − p ) ( − ν ∗ ( A ) μ 0 ( A ) Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) ) If p = 1 , we get u ≥ u ∗ , as desired. If p < 1 , we divide both sides by ( 1 − p ) ν ∗ ( A ) μ 0 ( A ) and get ( p 1 − p μ 0 ( A ) ν ∗ ( A ) + 1 ) ( u − u ∗ ) ≥ − 2 Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) u ≥ u ∗ − 2 Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) p 1 − p μ 0 ( A ) ν ∗ ( A ) + 1 u ≥ u ∗ − 2 Γ μ 0 ( A ) d tv ( μ 0 ∣ A , ν ∗ ∣ A ) #Proposition A.9 In the setting of Proposition A.8, assuming p > 0 but sans the assumption ν ∗ ( A ) > 0 : U ( π ⊗ α ρ ∗ , μ 0 ) ≥ max ρ : T → P ( S 2 ) min μ ∈ Φ U ( π ⊗ α ρ , μ ) − 1 − p p Γ ν ∗ ( A ) #Proof of Proposition A.9 We use the same notation as in the proof of Proposition A.8. As before, we have min ξ ∈ Ψ U ( π ⊗ α τ ∗ , ξ ) ≥ p u ∗ + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) E t ∼ α ∗ π [ E τ ∗ ( t ) × ν ∗ [ u 2 ∣ A ] ] ) U ( π ⊗ α ρ ∗ , ξ 0 ) = p u + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) E t ∼ α ∗ π [ E ρ ∗ ( t ) × ν ∗ [ u 2 ∣ A ] ] ) Combining, we get p u + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) E t ∼ α ∗ π [ E ρ ∗ ( t ) × ν ∗ [ u 2 ∣ A ] ] ) ≥ p u ∗ + ( 1 − p ) ( E π × ν ∗ [ u 1 ] + ν ∗ ( A ) E t ∼ α ∗ π [ E τ ∗ ( t ) × ν ∗ [ u 2 ∣ A ] ] ) u ≥ u ∗ + 1 − p p ν ∗ ( A ) E t ∼ α ∗ π [ E τ ∗ ( t ) × ν ∗ [ u 2 ∣ A ] − E ρ ∗ ( t ) × ν ∗ [ u 2 ∣ A ] ] u ≥ u ∗ + 1 − p p Γ ν ∗ ( A ) #Definition A.3 Denote x O ∗ : = { x y ∣ y ∈ O ∗ } , ¯ x O ∗ : = O ∗ ∖ x O ∗ . Given any x ∈ O ∗ , the splitting of ( O ∗ → A , O ω , u ) at x is defined as follows. S 1 : = ¯ x O ∗ → A S 2 : = x O ∗ → A A : = x O ω T : = A | x | α ( s ) n : = s ( x < n ) Given s : ¯ x O ∗ → A and e ∈ x O ω , define e s ∈ ( A × O ) | x | by e s n : = ( s ( e < n ) , e n ) . Given e ∈ ¯ x O ω , define e s ∈ ( A × O ) ω by e s n : = ( s ( e < n ) , e n ) . Define u 1 by u 1 ( s , e ) : = | e s | ∑ n = 0 γ ( n ) r ( e s < n ) Given t ∈ A | x | , s : x O ∗ → A and e ∈ x O ω , define e t s ∈ ( A × O ) ω by e t s n : = { ( t n , e n ) if n < | x | ( s ( e < n , e n ) if n ≥ | x | Define u 2 by u 2 ( s , t , e ) : = { ∑ ∞ n = | x | + 1 γ ( n ) r ( e t s < n ) if x ⊏ e 0 otherwise It is easy to see that this is indeed a splitting. #Proof of Theorem 1 Fix μ 0 ∈ Φ . Let ν ∗ ∈ Φ ′ be as in Proposition 2. Define M , N ⊆ O ω by M : = { e ∈ O ω ∣ lim n → ∞ d tv ( μ 0 ∣ e < n O ω , ν ∗ ∣ e < n O ω ) = 0 } N : = { e ∈ O ω ∣ lim n → ∞ ν ∗ ( e < n O ω ) μ 0 ( e < n O ω ) = 0 } By Corollary B, μ 0 ( M ∪ N ) = 1 . Consider any e ∈ M . By definition of M , for any n ∈ N we have μ 0 ( e < n O ω ) > 0 and ν ∗ ( e < n O ω ) > 0 . Therefore, we can apply Proposition A.8 to the splitting of ( O ∗ → A , O ω , u ) at e < n , with π = π ∗ . This gives us U ( π ∗ , μ 0 ) ≥ v ( e < n ) − 2 Γ n μ 0 ( e < n O ω ) d tv ( μ 0 ∣ e < n O ω , ν ∗ ∣ e < n O ω ) Here, Γ n ≤ ( sup r − inf r ) ∑ m > n γ ( n ) . v ( e < n ) − U ( π ∗ , μ 0 ) Γ n μ 0 ( e < n O ω ) ≤ 2 d tv ( μ 0 ∣ e < n O ω , ν ∗ ∣ e < n O ω ) By definition of M , this implies lim n → ∞ max ( v ( e < n ) − U ( π ∗ , μ 0 ) Γ n μ 0 ( e < n O ω ) , 0 ) = 0 Now, consider any e ∈ N . By definition of N , for any n ∈ N we have μ 0 ( e < n O ω ) > 0 . Therefore, we can apply Proposition A.9 to the splitting of ( O ∗ → A , O ω , u ) at e < n , with π = π ∗ . This gives us U ( π ∗ , μ 0 ) ≥ v ( e < n ) − 1 − p p Γ n ν ∗ ( e < n O ω ) v ( e < n ) − U ( π ∗ , μ 0 ) Γ n μ 0 ( e < n O ω ) ≤ 1 − p p ν ∗ ( e < n O ω ) μ 0 ( e < n O ω ) By definition of N , this also implies lim n → ∞ max ( v ( e < n ) − U ( π ∗ , μ 0 ) Γ n μ 0 ( e < n O ω ) , 0 ) = 0 ##Appendix B The following theorem is adapted from Blackwell and Dubbins (1962) . #Theorem B.1 Consider any μ , ν ∈ P ( O ω ) . Assume that μ is absolutely continuous with respect to ν . Then: Pr e ∼ μ [ lim n → ∞ d tv ( μ ∣ e < n O ω , ν ∣ e < n O ω ) = 0 ] = 1 #Theorem B.2 Consider any μ , ν ∈ P ( O ω ) . Define { D n : O ω → R ⊔ { + ∞ } } n ∈ N by D n ( x ) : = { μ ( x < n O ω ) ν ( x < n O ω ) if ν ( x < n O ω ) > 0 + ∞ otherwise Define D : = lim sup n → ∞ D n . Then, for any Borel A ⊆ O ω : μ ( A ) = ∫ A D ( x ) d ν ( x ) + μ ( A ∩ D − 1 ( + ∞ ) ) #Proof of Theorem B.2 This is almost a special case of Theorem 5.3.3 in Durret (2010) , except that we don't assume μ is locally absolutely continuous w.r.t. ν (i.e. we don't assume that μ ( x O ω ) = 0 whenever ν ( x O ω ) = 0 ). Careful reading of the proof shows that in our case it doesn't matter: D n ( X n is Durret's notation) is no longer a ν -martingale but is still a ν -supermartingale, and the identity X n = Y n Z n still holds if the fraction is understood to stand for + ∞ whenever Z n = 0 . #Corollary B Consider any μ , ν ∈ P ( O ω ) . Define A : = { e ∈ O ω ∣ lim n → ∞ d tv ( μ ∣ e < n O ω , ν ∣ e < n O ω ) = 0 } B : = { e ∈ O ω ∣ lim n → ∞ ν ( e < n O ω ) μ ( e < n O ω ) = 0 } Then, μ ( A ∪ B ) = 1 . #Proof of Corollary B Assume that E ν [ D ] > 0 . Then, we can define μ r ∈ P ( O ω ) by μ r ( C ) : = ∫ C D ( x ) d ν ( x ) ∫ O ω D ( x ) d ν ( x ) Obviously, μ r is absolutely continuous w.r.t. ν , therefore we can use Theorem B.1 to conclude Pr e ∼ μ r [ lim n → ∞ d tv ( μ r ∣ e < n O ω , ν ∣ e < n O ω ) = 0 ] = 1 By Theorem B.2, μ r is dominated by μ and in particular is absolutely continuous w.r.t. μ . Therefore, again by Theorem B.1: Pr e ∼ μ r [ lim n → ∞ d tv ( μ r ∣ e < n O ω , μ ∣ e < n O ω ) = 0 ] = 1 Using the triangle inequality for d tv , we get Pr e ∼ μ r [ lim n → ∞ d tv ( μ ∣ e < n O ω , ν ∣ e < n O ω ) = 0 ] = 1 By definition of μ r and A , this means that ∫ A D ( x ) d ν ( x ) ∫ O ω D ( x ) d ν ( x ) = 1 ∫ A D ( x ) d ν ( x ) = ∫ O ω D ( x ) d ν ( x ) This holds even without the assumption E ν [ D ] > 0 , since if E ν [ D ] = 0 then both sides vanish. ν ( e < n O ω ) μ ( e < n O ω ) is μ -supermatingale, therefore (by Doob's convergence theorem) its limit exists μ -almost surely. If the limit exists for some e ∈ O ω , then it vanishes iff D ( e ) = + ∞ . It follows that μ ( B ∩ D − 1 ( + ∞ ) ) = μ ( D − 1 ( + ∞ ) ) By Theorem B.2 μ ( A ∪ B ) = ∫ A ∪ B D ( x ) d ν ( x ) + μ ( ( A ∪ B ) ∩ D − 1 ( + ∞ ) ) μ ( A ∪ B ) ≥ ∫ A D ( x ) d ν ( x ) + μ ( B ∩ D − 1 ( + ∞ ) ) μ ( A ∪ B ) ≥ ∫ O ω D ( x ) d ν ( x ) + μ ( D − 1 ( + ∞ ) ) Applying Theorem B.2 to the right hand side: μ ( A ∪ B ) ≥ μ ( O ω ) = 1