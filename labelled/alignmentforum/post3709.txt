Previously , we defined a setting called "Delegative Inverse Reinforcement Learning" (DIRL) in which the agent can delegate actions to an "advisor" and the reward is only visible to the advisor as well. We proved a sublinear regret bound (converted to traditional normalization in online learning, the bound is O ( n 2 / 3 ) ) for one-shot DIRL (as opposed to standard regret bounds in RL which are only applicable in the episodic setting). However, this required a rather strong assumption about the advisor: in particular, the advisor had to choose the optimal action with maximal likelihood. Here, we consider "Delegative Reinforcement Learning" (DRL), i.e. a similar setting in which the reward is directly observable by the agent. We also restrict our attention to finite MDP environments (we believe these results can be generalized to a much larger class of environments, but not to arbitrary environments). On the other hand, the assumption about the advisor is much weaker: the advisor is only required to avoid catastrophic actions (i.e. actions that lose value to zeroth order in the interest rate) and assign some positive probability to a nearly optimal action. As before, we prove a one-shot regret bound (in traditional normalization, O ( n 3 / 4 ) ). Analogously to before , we allow for "corrupt" states in which both the advisor and the reward signal stop being reliable. Appendix A contains the proofs and Appendix B contains propositions proved before. Notation The notation K : X k → Y means K is Markov kernel from X to Y . When Y is a finite set, this is the same as a measurable function K : X → Δ Y , and we use these notations interchangeably. Given K : X k → Y and A ⊆ Y (corr. y ∈ Y ), we will use the notation K ( A ∣ x ) (corr K ( y ∣ x ) ) to stand for Pr y ′ ∼ K ( x ) [ y ′ ∈ A ] (corr. Pr y ′ ∼ K ( x ) [ y ′ = y ] ). Given Y is a finite set, μ ∈ Δ Y ω , h ∈ Y ∗ and y ∈ Y , the notation μ ( y ∣ h ) means Pr x ∼ μ [ x | h | = y ∣ x : | h | = h ] . Given Ω a measurable space, μ ∈ Δ Ω , n , m ∈ N , { A k } k ∈ [ n ] , { B j } j ∈ [ m ] finite sets and { X k : Ω → A k } k ∈ [ n ] , { Y j : Ω → B j } j ∈ [ m ] random variables (measurable mappings), the mutual information between the joint distribution of the X k and the joint distribution of the Y j will be denoted I ω ∼ μ [ X 0 , X 1 … X n − 1 ; Y 0 , Y 1 … Y m − 1 ] We will parameterize our geometric time discount by γ = e − 1 / t , thus all functions that were previously defined to depend on t are now considered functions of γ . Results We start by explaining the relation between the formalism of general environments we used before and the formalism of finite MDPs. Definition 1 A finite Markov Decision Process (MDP) is a tuple M = ( S M , A M , T M : S M × A M k → S M , R M : S M → [ 0 , 1 ] ) Here, S M is a finite set (the set of states), A M is a finite set (the set of actions), T M is the transition kernel and R M is the reward function. A stationary policy for M is any π : S M k → A M . The space of stationary policies is denoted Π M . Given π ∈ Π M , we define T M π : S M k → S M by T M π ( t ∣ s ) : = ∑ a ∈ A M T M ( t ∣ s , a ) π ( a ∣ s ) We define V M : S M × ( 0 , 1 ) → [ 0 , 1 ] and Q M : S M × A M × ( 0 , 1 ) → [ 0 , 1 ] by V M ( s , γ ) : = ( 1 − γ ) max π ∈ Π M ∞ ∑ n = 0 γ n E T n M π ( s ) [ R M ] Q M ( s , a , γ ) : = ( 1 − γ ) R M ( s ) + γ E t ∼ T M ( s , a ) [ V M ( t , γ ) ] Here, T n M π : S M k → S M is just the n -th power of T M π in the sense of Markov kernel composition. As well known, V M and Q M are rational functions in γ for 1 − γ ≪ 1 , therefore in this limit we have the Taylor expansions V M ( s , γ ) = ∞ ∑ k = 0 1 k ! V k M ( s ) ⋅ ( 1 − γ ) k Q M ( s , a , γ ) = ∞ ∑ k = 0 1 k ! Q k M ( s , a ) ⋅ ( 1 − γ ) k Given any s ∈ S M , we define { A k M ( s ) ⊆ A M } k ∈ N recursively by A 0 M ( s ) : = a r g m a x a ∈ A M Q 0 M ( s , a ) A k + 1 M ( s ) : = a r g m a x a ∈ A k M ( s ) Q k + 1 M ( s , a ) All MDPs will be assumed to be finite, so we drop the adjective "finite" from now on. Definition 2 Let I = ( A , O ) be an interface. An I -universe υ = ( μ , r ) is said to be an O -realization of MDP M with state function S : hdom μ → S M when A M = A and for any h ∈ hdom μ , a ∈ A and o ∈ O T M ( s ∣ S ( h ) , a ) = Pr o ∼ μ ( h a ) [ S ( h a o ) = s ] r ( h ) = R M ( S ( h ) ) Now now define the relevant notion of a "good advisor." Definition 3 Let υ = ( μ , r ) be a universe and ϵ > 0 . A policy π is said to be ϵ -sane for υ when there are M , S s.t. υ is an O -realization of M with state function S and for any h ∈ hdom μ i. supp π ( h ) ⊆ A 0 M ( S ( h ) ) ii. ∃ a ∈ A 1 M ( S ( h ) ) : π ( a ∣ h ) > ϵ We can now formulate the regret bound. Theorem 1 Fix an interface I and ϵ > 0 . Consider H = { υ k = ( μ k , r ) ∈ Υ I } k ∈ [ N ] for some N ∈ N (note that r doesn't depend on k ). Assume that for each k ∈ [ N ] , σ k is an ϵ -sane policy for υ k . Then, there is an ¯ I -metapolicy π ∗ s.t. for any k ∈ [ N ] EU ∗ υ k ( γ ) − EU π ∗ ¯ υ k [ σ k ] ( γ ) = O ( ( 1 − γ ) 1 / 4 ) Corollary 1 Fix an interface I and ϵ > 0 . Consider H = { υ k = ( μ k , r ) ∈ Υ I } k ∈ N . Assume that for each k ∈ N , σ k is a ϵ -sane policy for υ k . Define ¯ H : = { ¯ υ k [ σ k ] } n ∈ N . Then, ¯ H is learnable. Now, we deal with corrupt states. Definition 4 Let υ = ( μ , r ) be a universe and ϵ > 0 . A policy π is said to be locally ϵ -sane for υ when there are M , S and U ⊆ S M (the set of uncorrupt states) s.t. υ is an O -realization of M with state function S , S ( λ ) ∈ U and for any h ∈ hdom μ , if S ( h ) ∈ U then i. If a ∈ supp π ( h ) and o ∈ supp μ ( h a ) then S ( h a o ) ∈ U . ii. supp π ( h ) ⊆ A 0 M ( S ( h ) ) iii. ∃ a ∈ A 1 M ( S ( h ) ) : π ( a ∣ h ) > ϵ iv. ∃ a ∈ A 2 M ( S ( h ) ) : T M ( U ∣ S ( h ) , a ) = 1 Of course, this requirement is still unrealistic for humans in the real world. In particular, it makes the formalism unsuitable for modeling the use of AI for catastrophe mitigation (which is ultimately what we are interested in!) since it assumes the advisor is already capable of avoiding any catastrophe. In following work, we plan to relax the assumptions further. Corollary 2 Fix an interface I and ϵ > 0 . Consider H = { υ k = ( μ k , r k ) ∈ Υ I } k ∈ [ N ] for some N ∈ N . Assume that for each k ∈ [ N ] , σ k is locally ϵ -sane for υ k . For each k ∈ [ N ] , let U k ⊆ S M k be the corresponding set of uncorrupt states. Assume further that for any k , j ∈ N and h ∈ hdom μ k ∩ hdom μ j , if S k ( h ) ∈ U k and S j ( h ) ∈ U j , then r k ( h ) = r j ( h ) . Then, there is an ¯ I -policy π ∗ s.t. for any k ∈ [ N ] EU ∗ υ k ( γ ) − EU π ∗ ¯ υ k [ σ k ] ( γ ) = O ( ( 1 − γ ) 1 / 4 ) Corollary 3 Assume the same conditions as in Corollary 2, except that H may be countable infinite. Then, ¯ H is learnable. Appendix A First, we prove an information theoretic bound that shows that for Thompson sampling, the expected information gain is bounded below by a function of the loss. Proposition A.1 Consider a probability space ( Ω , P ∈ Δ Ω ) , N ∈ N , R ⊆ [ 0 , 1 ] a finite set and random variables U : Ω → R , K : Ω → [ N ] and J : Ω → [ N ] . Assume that K ∗ P = J ∗ P = ζ ∈ Δ [ N ] and I [ K ; J ] = 0 . Then I [ K ; J , U ] ≥ 2 ( min i ∈ [ N ] ζ ( i ) ) ( E [ U ∣ J = K ] − E [ U ] ) 2 Proof of Proposition A.1 We have I [ K ; J , U ] = I [ K ; J ] + I [ K ; U ∣ J ] = I [ K ; U ∣ J ] = E [ D K L ( U ∗ ( P ∣ K , J ) ∥ U ∗ ( P ∣ J ) ) ] Using Pinsker's inequality, we get I [ K ; J , U ] ≥ 2 E [ d tv ( U ∗ ( P ∣ K , J ) , U ∗ ( P ∣ J ) ) 2 ] ≥ 2 E [ ( E [ U ∣ K , J ] − E [ U ∣ J ] ) 2 ] Denote U k j : = E [ U ∣ K = k , J = j ] . We get I [ K ; J , U ] ≥ 2 E ( k , j ) ∼ ζ × ζ [ ( U k j − E k ′ ∼ ζ [ U k ′ j ] ) 2 ] ≥ 2 E ( k , j ) ∼ ζ × ζ [ [ [ k = j ] ] ( U k j − E k ′ ∼ ζ [ U k ′ j ] ) 2 ] I [ K ; J , U ] ≥ 2 E j ∼ ζ [ ζ ( j ) ( U j j − E k ∼ ζ [ U k j ] ) 2 ] ≥ 2 ( min j ∈ [ N ] ζ ( j ) ) E j ∼ ζ [ ( U j j − E k ∼ ζ [ U k j ] ) 2 ] I [ K ; J , U ] ≥ 2 ( min j ∈ [ N ] ζ ( j ) ) ( E j ∼ ζ [ U j j ] − E ( k , j ) ∼ ζ × ζ [ U k j ] ) 2 = 2 ( min i ∈ [ N ] ζ ( i ) ) ( E [ U ∣ J = K ] − E [ U ] ) 2 Now, we describe a "delegation routine" D that can transform any "proto-policy" π that recommends some set of actions from A into an actual ¯ I -policy s.t (i)  with high probability, on each round, either a "safe" recommended action is taken, or all recommended actions are "unsafe" or delegation is performed and (ii) the expected number of delegations is small. For technical reasons, we also need to the modified routines D ! k which behave the same way as D except for some low probability cases. Proposition A.2 Fix an interface I = ( A , O ) , N ∈ N , ϵ ∈ ( 0 , 1 | A | ) , δ ∈ ( 0 , 1 N ) . Consider some { σ k : ( A × O ) ∗ k → A } k ∈ [ N ] . Then, there exist D : ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ × 2 A → ¯ A and { D ! k : ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ × 2 A → ¯ A } k ∈ [ N ] with the following properties. Given x ∈ ( 2 A × ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ) ∗ , we denote x – – its projection to ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ . Thus, x – – – – ∈ ( A × O ) ∗ .
Given μ an I -environment, π : hdom μ k → 2 A , D ′ : ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ × 2 A → ¯ A and k ∈ [ N ] , we can define Ξ [ μ , σ k , D ′ , π ] ∈ Δ ( 2 A × ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ) ω as follows Ξ [ μ , σ k , D ′ , π ] ( B , a , o ∣ x ) : = π ( B ∣ x – – – – ) D ′ ( a ∣ x – – , B ) ¯ μ [ σ k ] ( o ∣ x – – a ) We require that for every π , μ and k as above, the following conditions hold i. E x ∼ Ξ [ μ , σ k , D ! k , π ] [ | { n ∈ N ∣ x n ∈ 2 A × ⊥ × ¯ O } | ] ≤ ln N δ ln ( 1 + ϵ ( 1 − ϵ ) ( 1 − ϵ ) / ϵ ) = O ( ln N δ ϵ ) ii. d tv ( 1 N ∑ N − 1 j = 0 Ξ [ μ , σ j , D , π ] , 1 N ∑ N − 1 j = 0 Ξ [ μ , σ j , D ! j , π ] ) ≤ ( N − 1 ) δ iii. For all x ∈ hdom ¯ μ [ σ k ] , if D ! k ( x , π ( x – – ) ) ≠ ⊥ then σ k ( D ! k ( x , π ( x – – ) ) ∣ x – – ) > 0 iv. For all x ∈ hdom ¯ μ [ σ k ] , if D ! k ( x , π ( x – – ) ) ∉ π ( x – – ) ∪ { ⊥ } then ∀ a ∈ π ( x – – ) : σ k ( a ∣ x – – ) ≤ ϵ In order to prove Proposition A.2, we need another mutual information bound. Proposition A.3 Consider N ∈ N , A a finite set, ϵ ∈ ( 0 , 1 | A | ) , δ ∈ ( 0 , 1 ) , B ⊆ A , ζ ∈ Δ [ N ] and σ : [ N ] k → A . Suppose that for every a ∈ A Pr k ∼ ζ [ σ ( a ∣ k ) > 0 ∧ ( a ∈ B ∨ ∀ b ∈ B : σ ( b ∣ k ) ≤ ϵ ) ] ≤ 1 − δ Then I ( k , a ) ∼ ζ ⋉ σ [ k ; a ] ≥ δ ln ( 1 + ϵ ( 1 − ϵ ) ( 1 − ϵ ) / ϵ ) Proof of Proposition A.3 We have I ( k , a ) ∼ ζ ⋉ σ [ k ; a ] = E k ∼ ζ [ D K L ( σ ( k ) ∥ σ ∗ ζ ) ] Define q ∈ ( 0 , 1 ) by q : = 1 ϵ + ( 1 − ϵ ) − ( 1 − ϵ ) / ϵ Let a ∗ ∈ A be s.t. ( σ ∗ ζ ) ( a ∗ ) > q ϵ and either a ∗ ∈ B or every a ∈ B has ( σ ∗ ζ ) ( a ) ≤ q ϵ . For every k ∈ [ N ] , denote A k : = { a ∈ A ∣ σ ( a ∣ k ) > 0 ∧ ( a ∈ B ∨ ∀ b ∈ B : σ ( b ∣ k ) ≤ ϵ ) } If a ∗ ∉ A k then either σ ( a ∗ ∣ k ) = 0 or there is a ∈ B s.t. ( σ ∗ ζ ) ( a ) ≤ q ϵ and σ ( b ∣ k ) ≥ ϵ . This implies D K L ( σ ( k ) ∥ σ ∗ ζ ) ≥ min ( D K L ( 0 ∥ q ϵ ) , D K L ( ϵ ∥ q ϵ ) ) We have D K L ( 0 ∥ q ϵ ) = ln 1 1 − q ϵ = ln 1 1 − ϵ ϵ + ( 1 − ϵ ) − ( 1 − ϵ ) / ϵ = ln ϵ + ( 1 − ϵ ) − ( 1 − ϵ ) / ϵ ϵ + ( 1 − ϵ ) − ( 1 − ϵ ) / ϵ − ϵ = ln ( 1 + ϵ ( 1 − ϵ ) ( 1 − ϵ ) / ϵ ) D K L ( ϵ ∥ q ϵ ) = ϵ ln ϵ q ϵ + ( 1 − ϵ ) ln 1 − ϵ 1 − q ϵ = ϵ ln 1 q + ( 1 − ϵ ) ln ( 1 − ϵ ) − ϵ ln 1 1 − q ϵ + ln 1 1 − q ϵ D K L ( ϵ ∥ q ϵ ) = ϵ ln 1 − q ϵ q + ln ( 1 − ϵ ) 1 − ϵ + ln 1 1 − q ϵ = ϵ ln ( 1 q − ϵ ) + ln ( 1 − ϵ ) 1 − ϵ + ln 1 1 − q ϵ D K L ( ϵ ∥ q ϵ ) = ϵ ln ( 1 − ϵ ) − ( 1 − ϵ ) / ϵ + ln ( 1 − ϵ ) 1 − ϵ + ln 1 1 − q ϵ = ln ( 1 − ϵ ) − ( 1 − ϵ ) + ln ( 1 − ϵ ) 1 − ϵ + ln 1 1 − q ϵ = ln 1 1 − q ϵ D K L ( ϵ ∥ q ϵ ) = ln ( 1 + ϵ ( 1 − ϵ ) ( 1 − ϵ ) / ϵ ) It follows that I ( k , a ) ∼ ζ ⋉ σ [ k ; a ] ≥ Pr k ∼ ζ [ a ∗ ∉ A k ] ln ( 1 + ϵ ( 1 − ϵ ) ( 1 − ϵ ) / ϵ ) ≥ δ ln ( 1 + ϵ ( 1 − ϵ ) ( 1 − ϵ ) / ϵ ) Proof of Proposition A.2 We define { A k : ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ × 2 A → 2 A } k ∈ N , ~ ζ : ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ k → [ N ] , ζ : ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ k → [ N ] , { ~ ζ ! k : ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ k → [ N ] } k ∈ N , { ζ ! k : ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ k → [ N ] } k ∈ N , D and { D ! k } k ∈ N recursively. For each h ∈ ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ , a ∈ ¯ A , o ∈ ¯ O , B ⊆ A and j , k ∈ [ N ] , we require A k ( h , B ) : = { a ∈ A ∣ σ k ( a ∣ h – – ) > 0 ∧ ( a ∈ B ∨ ∀ b ∈ B : σ k ( b ∣ h – – ) ≤ ϵ ) } ~ ζ ( k ∣ λ ) = ~ ζ ! j ( k ∣ λ ) : = 1 N ~ ζ ( k ∣ h a o ) : = ⎧ ⎪
⎪
⎪ ⎨ ⎪
⎪
⎪ ⎩ ζ ( k ∣ h ) if a ≠ ⊥ 1 N if a = ⊥ , ∑ N − 1 i = 0 ζ ( i ∣ h ) ⋅ σ i ( b ∣ h – – ) = 0 ( ∑ N − 1 i = 0 ζ ( i ∣ h ) ⋅ σ i ( b ∣ h – – ) ) − 1 ζ ( k ∣ h ) ⋅ σ k ( b ∣ h – – ) otherwise, assuming o ∈ b O ~ ζ ! j ( k ∣ h a o ) : = ⎧ ⎨ ⎩ ζ ! j ( k ∣ h ) if a ≠ ⊥ ( ∑ N − 1 i = 0 ζ ! j ( i ∣ h ) ⋅ σ i ( b ∣ h – – ) ) − 1 ζ ! j ( k ∣ h ) ⋅ σ k ( b ∣ h – – ) if a = ⊥ , o ∈ b O ζ ( k ∣ h ) : = ~ ζ ( k ∣ h ) [ [ ~ ζ ( k ∣ h ) ≥ δ ] ] ∑ N − 1 i = 0 ~ ζ ( i ∣ h ) [ [ ~ ζ ( i ∣ h ) ≥ δ ] ] ζ ! j ( k ∣ h ) : = ~ ζ ! j ( k ∣ h ) [ [ ~ ζ ! j ( k ∣ h ) ≥ δ ] ] ∑ N − 1 i = 0 ~ ζ ! j ( i ∣ h ) [ [ ~ ζ ! j ( i ∣ h ) ≥ δ ] ] [ [ ~ ζ ! j ( j ∣ h ) ≥ δ ] ] + [ [ k = j ] ] ⋅ [ [ ~ ζ ! j ( j ∣ h ) < δ ] ] D ( h , B ) : = { any a s.t. ∀ k ∈ supp ζ ( h ) : a ∈ A k ( h , B ) if such exists ⊥ otherwise D ! j ( h , B ) : = { any a s.t. ∀ k ∈ supp ζ ! j ( h ) : a ∈ A k ( h , B ) if such exists ⊥ otherwise Denote Ξ ! k : = Ξ [ μ , σ k , D ! k , π ] . Proposition A.3 implies that for any k ∈ [ N ] ln N ≤ ∞ ∑ n = 0 E x ∼ Ξ ! k [ H ( ζ ! k ( x – – : n + 1 ) ) − H ( ζ ! k ( x – – : n ) ) ] ≤ ∞ ∑ n = 0 Pr x ∼ Ξ ! k [ x n ∈ 2 A × ⊥ × O ] δ ln ( 1 + ϵ ( 1 − ϵ ) 1 − ϵ ϵ ) This gives us condition i. Condition ii follows because the only difference is in the equation for ζ vs. ζ ! j . That is, ζ may "discard" the "correct" element of [ N ] but this happens with probability at most δ per discard and there are at most N − 1 discards. Conditions iii and iv are obvious from the definition. Definition A.1 Consider k ∈ N and a universe υ = ( μ , r ) that is an O -realization of M with state function S . A policy π is called k -optimal for υ when for any h ∈ hdom μ supp π ( h ) ⊆ A k M ( S ( h ) ) π is called Blackwell optimal for υ when it is k -optimal for any k ∈ N . Obviously, a stationary Blackwell optimal policy always exists. It is a standard (up to straightforward adaption to our formalism) result in MDP theory that any Blackwell optimal policy has maximal expected utility for any γ sufficiently close to 1. The following proposition relates optimality in terms of expected utility to expected truncated utility, where truncated utility is defined by only summing rewards within a time duration T . Proposition A.4 Fix an MDP M . Then, for any γ ∈ ( 0 , 1 ) , T ∈ N , universe υ = ( μ , r ) that is an O -realization of M with state function S , π 1 a 1 -optimal policy for υ and π ∗ a Blackwell optimal policy for υ , we have T − 1 ∑ n = 0 γ n ( E x ∼ μ ⋈ π ∗ [ r ( x : n ) ] − E x ∼ μ ⋈ π 1 [ r ( x : n ) ] ) ≤ O ( 1 + T ( 1 − γ ) ) Proof of Proposition A.4 Let π ∗ 1 be a policy s.t. for any h ∈ hdom μ π ∗ 1 ( h ) : = { π 1 ( h ) if | h | < T π ∗ ( h ) otherwise By Proposition B.1 EU ∗ υ ( γ ) − EU π ∗ 1 υ ( γ ) = ∞ ∑ n = 0 γ n E x ∼ μ ⋈ π ∗ 1 [ V υ γ ( x : n ) − Q υ γ ( x : n , x A n ) ] EU ∗ υ ( γ ) − EU π ∗ 1 υ ( γ ) = ∞ ∑ n = 0 γ n E x ∼ μ ⋈ π ∗ 1 [ V M ( S ( x : n ) , γ ) − Q M ( S ( x : n ) , x A n , γ ) ] EU ∗ υ ( γ ) − EU π ∗ 1 υ ( γ ) = ∞ ∑ n = 0 γ n ∞ ∑ k = 0 ( 1 − γ ) k k ! E x ∼ μ ⋈ π ∗ 1 [ V k M ( S ( x : n ) ) − Q k M ( S ( x : n ) , x A n ) ] Using the Blackwell optimality of π ∗ and 1-optimality of π 1 , we get that for 1 − γ ≪ 1 EU ∗ υ ( γ ) − EU π ∗ 1 υ ( γ ) = T − 1 ∑ n = 0 γ n ∞ ∑ k = 2 ( 1 − γ ) k k ! E x ∼ μ ⋈ π 1 [ V k M ( S ( x : n ) ) − Q k M ( S ( x : n ) , x A n ) ] EU ∗ υ ( γ ) − EU π ∗ 1 υ ( γ ) ≤ T − 1 ∑ n = 0 γ n max s ∈ S M max a ∈ A 1 M ( s ) ∞ ∑ k = 2 ( 1 − γ ) k k ! ( V k M ( s ) − Q k M ( s , a ) ) EU ∗ υ ( γ ) − EU π ∗ 1 υ ( γ ) = O ( T ( 1 − γ ) 2 ) ( 1 − γ ) ∞ ∑ n = 0 γ n ( E x ∼ μ ⋈ π ∗ [ r ( x : n ) ] − E x ∼ μ ⋈ π ∗ 1 [ r ( x : n ) ] ) = O ( T ( 1 − γ ) 2 ) ∞ ∑ n = 0 γ n ( E x ∼ μ ⋈ π ∗ [ r ( x : n ) ] − E x ∼ μ ⋈ π ∗ 1 [ r ( x : n ) ] ) = O ( T ( 1 − γ ) ) Denote ρ ∗ : = μ ⋈ π ∗ , ρ 1 : = μ ⋈ π 1 . Using again the Blackwell optimality of π ∗ T − 1 ∑ n = 0 γ n ( E x ∼ ρ ∗ [ r ( x : n ) ] − E x ∼ ρ 1 [ r ( x : n ) ] ) + γ T 1 − γ ( E x ∼ ρ ∗ [ V M ( S ( x : T ) ) ] − E x ∼ ρ 1 [ V M ( S ( x : T ) ) ] ) = O ( T ( 1 − γ ) ) Since both π ∗ and π 1 are in particular 0-optimal, we have E x ∼ ρ ∗ [ V 0 M ( S ( x : T ) ) ] = E x ∼ ρ 1 [ V 0 M ( S ( x : T ) ) ] = V 0 M ( S ( λ ) ) It follows T − 1 ∑ n = 0 γ n ( E x ∼ ρ ∗ [ r ( x : n ) ] − E x ∼ ρ 1 [ r ( x : n ) ] ) ± γ T 1 − γ O ( 1 − γ ) = O ( T ( 1 − γ ) ) T − 1 ∑ n = 0 γ n ( E x ∼ ρ ∗ [ r ( x : n ) ] − E x ∼ ρ 1 [ r ( x : n ) ] ) = O ( γ T + T ( 1 − γ ) ) The following shows that for any policy that doesn't make "irreversible errors," regret can be approximated by "episodic regret" for sufficiently large episode duration. Proposition A.5 Consider a universe υ = ( μ , r ) that is an O -realization of M with state function S . Suppose that π ∗ is a Blackwell optimal policy for υ and π 0 is a 0 -optimal policy for υ . For any n ∈ N , let π ∗ n be a policy s.t. for any h ∈ hdom μ π ∗ n ( h ) : = { π 0 ( h ) if | h | < n T π ∗ ( h ) otherwise Then, for any γ ∈ ( 0 , 1 ) and T ∈ N + EU ∗ υ ( γ ) − EU π 0 υ ( γ ) ≤ ( 1 − γ ) ∞ ∑ n = 0 T − 1 ∑ m = 0 γ n T + m ( E x ∼ μ ⋈ π ∗ n [ r ( x : n T + m ) ] − E x ∼ μ ⋈ π 0 [ r ( x : n T + m ) ] ) + O ( 1 − γ 1 − γ T ) Proof of Proposition A.5 By Proposition B.1, for any l ∈ N EU ∗ υ ( γ ) − EU π ∗ l υ ( γ ) = ∞ ∑ n = 0 γ n E x ∼ μ ⋈ π ∗ l [ V υ γ ( x : n ) − Q υ γ ( x : n , x A n ) ] π ∗ l becomes Blackwell optimal after l T , therefore for 1 − γ ≪ 1 , EU ∗ υ ( γ ) − EU π ∗ l υ ( γ ) = l T − 1 ∑ n = 0 γ n E x ∼ μ ⋈ π 0 [ V υ γ ( x : n ) − Q υ γ ( x : n , x A n ) ] EU π ∗ l υ ( γ ) − EU π ∗ l + 1 υ ( γ ) = ( l + 1 ) T − 1 ∑ n = l T γ n E x ∼ μ ⋈ π 0 [ V υ γ ( x : n ) − Q υ γ ( x : n , x A n ) ] ( 1 − γ ) ∞ ∑ n = 0 γ n ( E x ∼ μ ⋈ π ∗ l [ r ( x : n ) ] − E x ∼ μ ⋈ π ∗ l + 1 [ r ( x : n ) ] ) = ( l + 1 ) T − 1 ∑ n = l T γ n E x ∼ μ ⋈ π 0 [ V υ γ ( x : n ) − Q υ γ ( x : n , x A n ) ] π ∗ l and π ∗ l + 1 coincide until l T , therefore ( 1 − γ ) ∞ ∑ n = l T γ n ( E x ∼ μ ⋈ π ∗ l [ r ( x : n ) ] − E x ∼ μ ⋈ π ∗ l + 1 [ r ( x : n ) ] ) = ( l + 1 ) T − 1 ∑ n = l T γ n E x ∼ μ ⋈ π 0 [ V υ γ ( x : n ) − Q υ γ ( x : n , x A n ) ] Denote ρ ∗ l : = μ ⋈ π ∗ l , ρ 0 : = μ ⋈ π 0 . We also use the shorthand notations r n : = r ( x : n ) , V n : = V υ γ ( x : n ) , Q n : = Q υ γ ( x : n , x A n ) . Both π ∗ l and π ∗ l + 1 is Blackwell optimal after ( l + 1 ) T , therefore ( 1 − γ ) ( l + 1 ) T − 1 ∑ n = l T γ n ( E ρ ∗ l [ r n ] − E ρ 0 [ r n ] ) + γ ( l + 1 ) T ( E ρ ∗ l [ V ( l + 1 ) T ] − E ρ 0 [ V ( l + 1 ) T ] ) = ( l + 1 ) T − 1 ∑ n = l T γ n E ρ 0 [ V n − Q n ] Since π 0 is 0-optimal, we get ( 1 − γ ) ( l + 1 ) T − 1 ∑ n = l T γ n ( E ρ ∗ l [ r n ] − E ρ 0 [ r n ] ) + O ( γ ( l + 1 ) T ( 1 − γ ) ) = ( l + 1 ) T − 1 ∑ n = l T γ n E ρ 0 [ V n − Q n ] Summing over l , we get ( 1 − γ ) ∞ ∑ l = 0 ( l + 1 ) T − 1 ∑ n = l T γ n ( E ρ ∗ l [ r n ] − E ρ 0 [ r n ] ) + O ( γ T ( 1 − γ ) 1 − γ T ) = ∞ ∑ n = 0 γ n E ρ 0 [ V n − Q n ] Applying Proposition B.1 to the right hand side ( 1 − γ ) ∞ ∑ l = 0 ( l + 1 ) T − 1 ∑ n = l T γ n ( E ρ ∗ l [ r n ] − E ρ 0 [ r n ] ) + O ( γ T ( 1 − γ ) 1 − γ T ) = EU ∗ υ ( γ ) − EU π 0 υ ( γ ) Proof of Theorem 1 Fix γ ∈ ( 0 , 1 ) , δ ∈ ( 0 , N − 1 ) and T ∈ N + . For each k ∈ [ N ] , suppose υ k is an O -realization of M k with state function S k and denote ν k : = ¯ μ k [ σ k ] . To avoid cumbersome notation, whenever M k should appear a subscript, we will replace it by k . Let ( Ω , P ∈ Δ Ω ) be a probability space. Let K : Ω → [ N ] be a random variable and the following be stochastic processes Z n , ~ Z n : Ω → Δ [ N ] J n : Ω → [ N ] Ψ n : Ω → 2 A A n : Ω → ¯ A Θ n : Ω → ¯ O We also define A Θ : n : Ω → ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ by A Θ : n : = A 0 Θ 0 A 1 Θ 1 … A n − 1 Θ n − 1 (The following conditions on A and Θ imply that the range of the above is indeed in ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ .) Let D and D ! k be as in Proposition A.2 (we assume w.l.o.g. that ϵ < 1 | A | ). We construct Ω , K , Z , ~ Z , J , Ψ , A and Θ s.t K is uniformly distributed and for any k ∈ [ N ] , l ∈ N , m ∈ [ T ] and o ∈ O , denoting n = l T + m ~ Z 0 ( k ) ≡ 1 N Z n ( k ) = ~ Z n ( k ) [ [ ~ Z n ( k ) ≥ δ ] ] ∑ N − 1 j = 0 ~ Z n ( j ) [ [ ~ Z n ( j ) ≥ δ ] ] Pr [ J l = k ∣ Z l T ] = Z l T ( k ) Ψ n = A 1 J l ( S J l ( A Θ : n ) ) Pr [ Θ n = o ∣ A Θ : n ] = ν K ( o ∣ A Θ : n ) A n = D ( A Θ : n , Ψ n ) ~ Z n + 1 ( k ) N − 1 ∑ j = 0 Z n ( j ) [ [ A n = D ! j ( A Θ : n , Ψ n ) ] ] ν j ( Θ n ∣ A Θ : n A n ) = Z n ( k ) [ [ A n = D ! k ( A Θ : n , Ψ n ) ] ] ν k ( Θ n ∣ A Θ : n A n ) Note that the last equation has the form of a Bayesian update which is allowed to be arbitrary when update is on "impossible" information. We now construct the ¯ I -policy π ∗ s.t. for any n ∈ N , h ∈ ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ s.t. Pr [ A Θ : n = h ] > 0 and a ∈ ¯ A π ∗ ( a ∣ h ) : = Pr [ A n = a ∣ A Θ : n = h ] That is, we perform Thompson sampling at time intervals of size T , moderated by the delegation routine D , and discard from our belief state hypotheses whose probability is below δ and hypotheses sampling which resulted in recommending "unsafe" actions i.e. actions that D refused to perform. In order to prove π ∗ has the desired property, we will define the stochastic processes Z ! , ~ Z ! , J ! , Ψ ! , A ! and Θ ! , each process of the same type as its shriekless counterpart (thus Ω is constructed to accommodate them). These processes are required to satisfy the following: ~ Z ! 0 ( k ) ≡ 1 N Z ! n ( k ) = ~ Z ! n ( k ) [ [ ~ Z ! n ( k ) ≥ δ ] ] ∑ N − 1 j = 0 ~ Z ! n ( j ) [ [ ~ Z ! n ( j ) ≥ δ ] ] [ [ ~ Z ! n ( K ) ≥ δ ] ] + [ [ K = k ] ] ⋅ [ [ ~ Z ! n ( K ) < δ ] ] Pr [ J ! l = k ∣ Z ! l T ] = Z ! l T ( k ) Ψ ! n = A 1 J ! l ( S J ! l ( A Θ ! : n ) ) Pr [ Θ ! n = o ∣ A Θ ! : n ] = ν K ( o ∣ A Θ ! : n ) A ! n = D ! K ( A Θ ! : n , Ψ ! n ) ~ Z ! n + 1 ( k ) = Z ! n ( k ) [ [ A ! n = D ! k ( A Θ ! : n , Ψ ! n ) ] ] ν k ( Θ ! n ∣ A Θ ! : n A ! n ) ∑ N − 1 j = 0 Z ! n ( j ) [ [ A ! n = D ! j ( A Θ ! : n , Ψ ! n ) ] ] ν j ( Θ ! n ∣ A Θ ! : n A ! n ) For any k ∈ [ N ] , we construct the ¯ I -policy π ? k s.t. for any n ∈ N , h ∈ ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ s.t. Pr [ A Θ ! : n = h , K = k ] > 0 and a ∈ ¯ A π ? k ( a ∣ h ) : = Pr [ A ! n = a ∣ A Θ ! : n = h , K = k ] Given any ¯ I -policy π and I -policy σ we define α σ π : ( A × O ) ∗ k → ¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯ A × O ∗ by α σ π ( g ∣ h ) : = [ [ h = g – ] ] C h | h | − 1 ∏ n = 0 ∑ a ∈ A ( [ [ g n ∈ ⊥ a O ] ] π ( ⊥ ∣ g : n ) σ ( a ∣ h : n ) + [ [ g n ∈ a ⊥ O ] ] π ( a ∣ g : n ) ) Here, C h ∈ R is a constant defined s.t. the probabilities sum to 1. We define the I -policy [ σ ] π – – by [ σ ] π – – ( a ∣ h ) : = Pr g ∼ α σ π ( h ) [ π ( g ) = a ∨ ( π ( g ) = ⊥ ∧ σ ( h ) = a ) ] Condition iii of Proposition A.2 and condition i of ϵ -sanity for σ k imply that for any h ∈ hdom μ k supp [ σ k ] π – – ? k ( h ) ⊆ A 0 k ( S k ( h ) ) This means we can apply Proposition A.5 and get EU ∗ υ k ( γ ) − EU π ? k ¯ υ k [ σ k ] ( γ ) ≤ ( 1 − γ ) ∞ ∑ n = 0 T − 1 ∑ m = 0 γ n T + m ( E x ∼ μ k ⋈ π ∗ k n [ r ( x : n T + m ) ] − E x ∼ ν k ⋈ π ? k [ r ( x – – : n T + m ) ] ) + O ( 1 − γ 1 − γ T ) Here, the I -policy π ∗ k n is defined as π ∗ n in Proposition A.5. We also define the ¯ I -policies π ! k n and π ! ! k n by π ! k n ( a ∣ h ) : = { π ? k ( a ∣ h ) if | h | < n T Pr [ A ! | h | = a ∣ A Θ ! : | h | = h , K = k , J ! n = k ] otherwise π ! ! k n ( a ∣ h ) : = ⎧ ⎪ ⎨ ⎪ ⎩ π ? k ( a ∣ h ) if | h | < n T π ! k n ( a ∣ h ) + π ! k n ( ⊥ ∣ h ) ⋅ π ∗ k n ( a ∣ h – – ) if | h | ≥ n T and a ≠ ⊥ 0 if | h | ≥ n T and a = ⊥ Denote ρ ∗ k n : = μ k ⋈ π ∗ k n , ρ ! ! k n : = ν k ⋈ π ! ! k n , ρ ! k n : = ν k ⋈ π ! k n , ρ ? k : = ν k ⋈ π ? k , R ? k = EU ∗ υ k ( γ ) − EU π ? k ¯ υ k [ σ k ] ( γ ) . For each n ∈ N , denote EU ∗ k n ( γ ) : = 1 − γ 1 − γ T T − 1 ∑ m = 0 γ m E x ∼ ρ ∗ k n [ r ( x : n T + m ) ] EU ! ! k n ( γ ) : = 1 − γ 1 − γ T T − 1 ∑ m = 0 γ m E x ∼ ρ ! ! k n [ r ( x – – : n T + m ) ] EU ! k n ( γ ) : = 1 − γ 1 − γ T T − 1 ∑ m = 0 γ m E x ∼ ρ ! k n [ r ( x – – : n T + m ) ] EU ? k n ( γ ) : = 1 − γ 1 − γ T T − 1 ∑ m = 0 γ m E x ∼ ρ ? k [ r ( x – – : n T + m ) ] We have R ? k ≤ ( 1 − γ T ) ∞ ∑ n = 0 γ n T ( EU ∗ k n ( γ ) − EU ? k n ( γ ) ) + O ( 1 − γ 1 − γ T ) R ? k ≤ ( 1 − γ T ) ∞ ∑ n = 0 γ n T ( EU ∗ k n ( γ ) − EU ! ! k n ( γ ) + EU ! ! k n ( γ ) − EU ! k n ( γ ) + EU ! k n ( γ ) − EU ? k n ( γ ) ) + O ( 1 − γ 1 − γ T ) Condition iv of Proposition A.2 and condition ii of ϵ -sanity for σ k imply that, given h ∈ hdom ν k s.t. | h | ≥ n T supp π ! k n ( h ) ⊆ A 1 k ( S k ( h – – ) ) ∪ { ⊥ } supp π ! ! k n ( h ) ⊆ A 1 k ( S k ( h – – ) ) Therefore, we can apply Proposition A.4 to the terms EU ∗ k n ( γ ) − EU ! ! k n ( γ ) and get R ? k ≤ ( 1 − γ T ) ∞ ∑ n = 0 γ n T ( EU ! ! k n ( γ ) − EU ! k n ( γ ) + EU ! k n ( γ ) − EU ? k n ( γ ) ) + O ( 1 − γ 1 − γ T + T ( 1 − γ ) 2 1 − γ T ) We have EU ! ! k n ( γ ) − EU ! k n ( γ ) ≤ Pr x ∼ ρ ! k n [ ∃ m ∈ [ T ] : x n T + m ∈ ⊥ ¯ O ] Thus, using condition i of Proposition A.2, we can bound the contribution of the EU ! ! k n ( γ ) − EU ! k n ( γ ) terms and get R ? k ≤ ( 1 − γ T ) ∞ ∑ n = 0 γ n T ( EU ! k n ( γ ) − EU ? k n ( γ ) ) + O ( 1 − γ T δ + 1 − γ 1 − γ T + T ( 1 − γ ) 2 1 − γ T ) We denote ξ ( γ , T , δ ) : = 1 − γ T δ + 1 − γ 1 − γ T + T ( 1 − γ ) 2 1 − γ T Define the random variables { U ! n : Ω → [ 0 , 1 ] } n ∈ N by U ! n : = 1 − γ 1 − γ T T − 1 ∑ m = 0 γ m r ( A Θ ! : n T + m ) Averaging the previous inequality over k , we get 1 N N − 1 ∑ k = 0 R ? k ≤ ( 1 − γ T ) ∞ ∑ n = 0 γ n T ( E [ U ! n ∣ J ! n = K ] − E [ U ! n ] ) + O ( ξ ( γ , T , δ ) ) 1 N N − 1 ∑ k = 0 R ? k ≤ ( 1 − γ T ) ∞ ∑ n = 0 γ n T E [ E [ U ! n ∣ J ! n = K , Z ! n T ] − E [ U ! n ∣ Z ! n T ] ] + O ( ξ ( γ , T , δ ) ) 1 N N − 1 ∑ k = 0 R ? k =  
 ⎷ ( 1 − γ T ) ∞ ∑ n = 0 γ n T E [ ( E [ U ! n ∣ J ! n = K , Z ! n T ] − E [ U ! n ∣ Z ! n T ] ) 2 ] + O ( ξ ( γ , T , δ ) ) We apply Proposition A.1 to each term in the sum over n . 1 N N − 1 ∑ k = 0 R ? k =  
 ⎷ ( 1 − γ T ) ∞ ∑ n = 0 γ n T E [ 1 2 δ I [ K ; J ! n , U ! n ∣ Z ! n T ] ] + O ( ξ ( γ , T , δ ) ) 1 N N − 1 ∑ k = 0 R ? k =  
 ⎷ 1 − γ T 2 δ ∞ ∑ n = 0 γ n T E [ H ( Z ! n T ) − H ( Z ! ( n + 1 ) T ) ] + O ( ξ ( γ , T , δ ) ) 1 N N − 1 ∑ k = 0 R ? k = √ 1 − γ T 2 δ ln N + O ( 1 − γ T δ + 1 − γ 1 − γ T + T ( 1 − γ ) 2 1 − γ T ) 1 N N − 1 ∑ k = 0 R ? k = O ⎛ ⎝ √ 1 − γ T δ + 1 − γ 1 − γ T + T ( 1 − γ ) 2 1 − γ T ⎞ ⎠ Condition ii of Proposition A.2 implies that d tv ( 1 N N − 1 ∑ k = 0 ¯ ν k [ σ k ] ⋈ π ∗ , 1 N N − 1 ∑ k = 0 ¯ ν k [ σ k ] ⋈ π ? k ) ≤ 2 ( N − 1 ) δ Here, the factor of 2 comes from the difference between the equations for Z n and Z ! n (we can construct and intermediate policy between π ∗ and π ? k and use the triangle inequality for d tv ). We conclude EU ∗ υ k ( γ ) − EU π ∗ ¯ υ k [ σ k ] ( γ ) = O ⎛ ⎝ δ + √ 1 − γ T δ + 1 − γ 1 − γ T + T ( 1 − γ ) 2 1 − γ T ⎞ ⎠ Now we set δ : = ( 1 − γ ) 1 / 4 , T : = ⌊ ( 1 − γ ) − 1 / 4 ⌋ . Since γ T → 1 as γ → 1 , we can use the approximation 1 − γ T ≈ T ( 1 − γ ) ≈ ( 1 − γ ) 3 / 4 . We get EU ∗ υ k ( γ ) − EU π ∗ ¯ υ k [ σ k ] ( γ ) = O ( ( 1 − γ ) 1 / 4 ) Proof of Corollary 1 Follows immediately from Theorem 1 and Proposition B.2. Definition A.2 Consider an MDP M and U ⊆ S M . The MDP M / U ∁ is defined by by S M / U ∁ : = U ⊔ { ⊥ } A M / U ∁ : = A M T M / U ∁ ( t ∣ s , a ) : = ⎧ ⎪
⎪
⎪ ⎨ ⎪
⎪
⎪ ⎩ T M ( t ∣ s , a ) if t , s ∈ U T M ( S M ∖ U ∣ s , a ) if t = ⊥ , s ∈ U 0 if t ∈ U , s = ⊥ 1 if t = s = ⊥ R M / U ∁ ( s ) : = { R M ( s ) if s ∈ U 0 if s = ⊥ Proposition A.6 Consider an MDP M and some U ⊆ S M . Suppose that for every s ∈ U there is a ∈ A k M ( s ) s.t. T M ( U ∣ s , a ) = 1 . Then, for every s ∈ S M and j ∈ [ k ] V j M ( s ) = V j M / U ∁ ( s ) Moreover, if a ∈ A is s.t. T M ( U ∣ s , a ) = 1 then Q j M ( s , a ) = Q j M / U ∁ ( s , a ) Proof of Proposition A.6 It is obvious that for any s ∈ U and γ ∈ ( 0 , 1 ) , V M / U ∁ ( s , γ ) ≤ V M ( s , γ ) . Now consider any π : S M → A s.t. for any s ∈ U , π ( s ) ∈ A k M ( s ) and T M π ( U ∣ s ) = 1 . Fix s ∈ U . For any n ∈ N , supp T n M π ( s ) ⊆ U and therefore ∞ ∑ n = 0 γ n E T n M / U ∁ π ( s ) [ R M / U ∁ ] = ∞ ∑ n = 0 γ n E T n M π ( s ) [ R M ] On the other hand, π is k -optimal and therefore ∞ ∑ n = 0 γ n E T n M π ( s ) [ R M ] = V M ( s ) − O ( ( 1 − γ ) k ) We conclude that V M / U ∁ ( s , γ ) ≥ ∞ ∑ n = 0 γ n E T n M / U ∁ π ( s ) [ R M / U ∁ ] = V M ( s , γ ) − O ( ( 1 − γ ) k ) | V M / U ∁ ( s , γ ) − V M ( s , γ ) | = O ( ( 1 − γ ) k ) This implies the equation for V j and the equation for Q j is implied in turn. Definition A.4 Fix an interface I = ( A , O ) . Consider an I -universe υ = ( μ , r ) which is an O -realization of M with state function S , and U ⊆ S M s.t. S ( λ ) ∈ U . Denote O ′ : = O ⊔ { ⊥ } and I ′ : = ( A , O ′ ) . The I ′ -universe υ / S U ∁ = ( μ / S U ∁ , r ′ ) is defined by μ / S U ∁ ( o ∣ h a ) = ⎧ ⎪
⎪
⎪
⎪
⎪
⎪ ⎨ ⎪
⎪
⎪
⎪
⎪
⎪ ⎩ μ ( o ∣ h a ) if h a o ∈ ( A × O ) ∗ and S ( h a o ) ∈ U 0 if h a o ∈ ( A × O ) ∗ and S ( h a o ) ∉ U T M / U ∁ ( ⊥ ∣ S ( h ) , a ) if h ∈ ( A × O ) ∗ and o = ⊥ 0 if h ∉ ( A × O ) ∗ and o ≠ ⊥ 1 if h ∉ ( A × O ) ∗ and o = ⊥ r ′ ( h ) : = { r ( h ) if h ∈ ( A × O ) ∗ 0 otherwise It is easy to see that υ / S U ∁ is an O ′ -realization of M / U ∁ with state function S ′ defined by S ′ ( h ) : = { S ( h ) if h ∈ ( A × O ) ∗ ⊥ otherwise Proposition A.7 Fix an interface I = ( A , O ) . Consider ϵ > 0 and υ = ( μ , r ) an O -realization of M with state function S . Suppose that π is a locally ϵ -sane policy for μ and U ⊆ S M is the corresponding set of uncorrupt states. Let π ′ be any I ′ -policy s.t. for any h ∈ ( A × O ) ∗ , π ( h ) = π ( h ′ ) . Then, π ′ is ϵ -sane for υ / S U ∁ . Proof of Proposition A.7 Without loss of generality, assumes all states of M are reachable from S ( λ ) (otherwise, υ is an O -realization of the MDP we get by discarding the unreachable states). Consider any h ∈ hdom μ / S U ∁ . If S ′ ( h ) = ⊥ then conditions i+ii of Definition 3 are trivial. Otherwise, we have h ∈ hdom μ and s : = S ( h ) ∈ U . We apply Proposition A.6 for k = 2 (by condition iv of Definition 4) and get that: conditions i+ii of Definition 4 imply condition i of Definition 3 and conditions i+iii of Definition 4 imply condition ii of Definition 3. Proof of Corollary 2 For every k ∈ [ N ] , denote ψ k : = υ k / S k U k ∁ . By Proposition A.7, σ k is ϵ -sane for ψ k (where we abuse notation by arbitrarily extending σ k to an I ′ -policy). Moreover, it is easy to see that all the ψ k share the same reward function r ′ . Apply Theorem 1 to H ′ : = { ψ k } k ∈ [ N ] . We get π ∗ s.t. for every k ∈ [ N ] and γ ∈ ( 0 , 1 ) EU ∗ ψ k ( γ ) − EU π ∗ ¯ ψ k [ σ k ] ( γ ) = O ( ( 1 − γ ) 1 / 4 ) Obviously EU π ∗ ¯ ψ k [ σ k ] ( γ ) ≤ EU π ∗ ¯ υ k [ σ k ] ( γ ) and therefore EU ∗ ψ k ( γ ) − EU π ∗ ¯ υ k [ σ k ] ( γ ) ≤ O ( ( 1 − γ ) 1 / 4 ) On the other hand, by Proposition A.6 EU ∗ ψ k ( γ ) = V M k / U k ∁ ( S ( λ ) , γ ) = V M k ( S ( λ ) , γ ) − O ( 1 − γ ) = EU ∗ υ k ( γ ) − O ( 1 − γ ) We conclude EU ∗ υ k ( γ ) − O ( 1 − γ ) − EU π ∗ ¯ υ k [ σ k ] ( γ ) ≤ O ( ( 1 − γ ) 1 / 4 ) EU ∗ υ k ( γ ) − EU π ∗ ¯ υ k [ σ k ] ( γ ) = O ( ( 1 − γ ) 1 / 4 ) Proof of Corollary 3 Follows immediately from Corollary 2 and Proposition B.2. Appendix B The following appeared before as Proposition A.5: Proposition B.1 Given α ∈ A × O , α A ∈ A and α O ∈ O are defined s.t. α = ( α A , α O ) . Consider a universe υ = ( μ , r ) , a policy π and γ ∈ ( 0 , 1 ) . Then, EU ∗ υ ( γ ) − EU π 0 υ ( γ ) = ∞ ∑ n = 0 γ n E x ∼ μ ⋈ π [ V υ γ ( x : n ) − Q υ γ ( x : n , x A n ) ] The followed appeared as Proposition 2: Proposition B.2 Fix an interface I . Let H be a countable set of meta-universes s.t. any finite G ⊆ H is learnable. Then, H is learnable.